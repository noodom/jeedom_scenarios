{
    "name": "Demande d actions sur plugins Jeemate",
    "isActive": "1",
    "group": "Gestion Plugins",
    "mode": "provoke",
    "schedule": "",
    "trigger": [
        "#begin_backup#",
        "#end_backup#"
    ],
    "timeout": "0",
    "isVisible": "0",
    "display": {
        "name": "Menu Plugins Jeemate",
        "icon": ""
    },
    "order": "9999",
    "description": "Affichage d'un menu des actions possibles sur les plugins Jeedom :\nSauvegarde, Restauration, Mise à jour et Suppression de sauvegarde",
    "configuration": {
        "timeDependency": 0,
        "has_return": 0,
        "logmode": "default",
        "allowMultiInstance": "0",
        "syncmode": "0",
        "timeline::enable": "0",
        "timeline::folder": ""
    },
    "state": "stop",
    "elements": [
        {
            "name": "",
            "type": "action",
            "options": [],
            "order": "0",
            "subElements": [
                {
                    "name": "",
                    "type": "action",
                    "subtype": "action",
                    "options": {
                        "collapse": "0",
                        "enable": "1"
                    },
                    "order": "0",
                    "expressions": [
                        {
                            "type": "element",
                            "subtype": "",
                            "expression": "1445",
                            "options": [],
                            "order": "0",
                            "element": {
                                "name": "",
                                "type": "comment",
                                "options": [],
                                "order": "0",
                                "subElements": [
                                    {
                                        "name": "",
                                        "type": "comment",
                                        "subtype": "comment",
                                        "options": {
                                            "collapse": "0"
                                        },
                                        "order": "0",
                                        "expressions": [
                                            {
                                                "type": "comment",
                                                "subtype": "",
                                                "expression": "Paramétrage du scénario :\n- scenarioExecutionActionsPluginsId : ID du scénario \"Exécution d actions sur plugins Jeemate\" ( \/!\\\/!\\ A MODIFIER OBLIGATOIREMENT \/!\\\/!\\)\n- scenarioUpdatePluginsId :  ID du scénario \"update plugins Jeemate\" ( \/!\\\/!\\ A MODIFIER OBLIGATOIREMENT \/!\\\/!\\)\n- backupPath : répertoire de sauvegarde des plugins (par défaut : \/var\/www\/html\/data\/custom\/plugins_backup)\n- nbPluginsGrouped : Nombre de plugins pour chaque groupe de la liste des plugins affichés\n- profile : ID de la commande \"(N) Notif Général\" d'un équipement du plugin Jeemate (rempli automatiquement à l'import du scénario)\n",
                                                "options": [],
                                                "order": "0"
                                            }
                                        ]
                                    }
                                ]
                            }
                        },
                        {
                            "type": "action",
                            "subtype": "",
                            "expression": "tag",
                            "options": {
                                "enable": "1",
                                "background": "0",
                                "name": "scenarioExecutionActionsPluginsId",
                                "value": "-1"
                            },
                            "order": "1"
                        },
                        {
                            "type": "action",
                            "subtype": "",
                            "expression": "tag",
                            "options": {
                                "enable": "1",
                                "background": "0",
                                "name": "scenarioUpdatePluginsId",
                                "value": "-1"
                            },
                            "order": "2"
                        },
                        {
                            "type": "action",
                            "subtype": "",
                            "expression": "tag",
                            "options": {
                                "enable": "1",
                                "background": "0",
                                "name": "backupPath",
                                "value": "\/var\/www\/html\/data\/custom\/plugins_backup"
                            },
                            "order": "3"
                        },
                        {
                            "type": "action",
                            "subtype": "",
                            "expression": "tag",
                            "options": {
                                "enable": "1",
                                "background": "0",
                                "name": "nbPluginsGrouped",
                                "value": "50"
                            },
                            "order": "4"
                        },
                        {
                            "type": "action",
                            "subtype": "",
                            "expression": "tag",
                            "options": {
                                "enable": "1",
                                "background": "0",
                                "name": "profile",
                                "value": "#[Notifications][nooMate2][(N) Notif Général]#"
                            },
                            "order": "5"
                        },
                        {
                            "type": "action",
                            "subtype": "",
                            "expression": "tag",
                            "options": {
                                "enable": "1",
                                "background": "0",
                                "name": "addScenarioName",
                                "value": "1"
                            },
                            "order": "6"
                        },
                        {
                            "type": "element",
                            "subtype": null,
                            "expression": "1548",
                            "options": [],
                            "order": "7",
                            "element": {
                                "name": null,
                                "type": "comment",
                                "options": [],
                                "order": "0",
                                "subElements": [
                                    {
                                        "name": null,
                                        "type": "comment",
                                        "subtype": "comment",
                                        "options": {
                                            "collapse": "0"
                                        },
                                        "order": "0",
                                        "expressions": [
                                            {
                                                "type": "comment",
                                                "subtype": null,
                                                "expression": "- separator : séparateur entre les noms de plugins (pour affichage de la liste)\n-> '<br\/>' : retour à la ligne\n-> ', ' virgule de séparation",
                                                "options": [],
                                                "order": "0"
                                            }
                                        ]
                                    }
                                ]
                            }
                        },
                        {
                            "type": "action",
                            "subtype": null,
                            "expression": "tag",
                            "options": {
                                "enable": "1",
                                "background": "0",
                                "name": "separator",
                                "value": ", "
                            },
                            "order": "8"
                        }
                    ]
                }
            ]
        },
        {
            "name": "",
            "type": "code",
            "options": [],
            "order": "0",
            "subElements": [
                {
                    "name": "",
                    "type": "code",
                    "subtype": "action",
                    "options": {
                        "collapse": "0",
                        "enable": "1"
                    },
                    "order": "0",
                    "expressions": [
                        {
                            "type": "code",
                            "subtype": "",
                            "expression": "\/* @noodom \/ Scénario de gestion des plugins Jeedom depuis Jeemate (Sauvegarde, Restauration, Mise à jour, Suppression de sauvegardes)\nNom du scénario : Demande d actions sur plugins\n\nInstallation du menu : https:\/\/github.com\/noodom\/jeedom_scenarios\/blob\/master\/updatePlugins\/README.md\n- Menu des actions possibles sur les plugins\n- Exécute les actions demandées par l'utilisateur avec l'appel du scénario \"Exécution d actions sur plugins Jeemate\"\n\n\/!\\ ATTENTION \/!\\ Ce scénario modifie le contenu du répertoires contenant les plugins Jeedom. \n\/!\\ Je vous laisse seul juge de la pertinence et de votre confiance à utiliser ce scénario pour la gestion de l'installation de vos plugins.\n\/!\\ Je décline donc toute responsabilité pour tout problème créé suite à l'exécution de ce scénario.\/!\\ \n\n\/!\\ Définir l'identifiant du scénario \"Exécution d actions sur plugins Jeemate\" avec la valeur du tag \"scenarioExecutionActionsPluginsId\" en début de scénario\n\/!\\ Définir l'identifiant du scénario \"update plugins Jeemate\" de l'équipement Jeemate utilisé avec la valeur du tag \"scenarioUpdatePluginsId\" en début de scénario\n\/!\\ (modification facultative) Définir le répertoire de sauvegarde des plugins utilisé par ce scénario avec la valeur du tag \"backupPath\" en début de scénario\n\/!\\ (modification facultative) Définir le nombre de plugins contenus dans chaque groupe de plugins affichés avec la valeur du tag \"nbPluginsGrouped\" en début de scénario\n\n*\/\n\n$scenario->setLog('Lancement des actions sur les plugins');\n\n$tags = $scenario->getTags();\n\n$tags['#redCircle#'] = \"\\u{1F534}\";\n$tags['#greenCircle#'] = \"\\u{1F7E2}\"; \/\/ 1F535 = bleu : Android toutes versions, 1F7E2 = vert : Android 10 ou plus\n$tags['#greenCheck#'] = \"\\u{2705}\";\n$tags['#whiteCheck#'] = \"\\u{2611}\";\n$tags['#arrow#'] = \"\\u{27A1}\";\n$tags['#disk#'] = \"\\u{1F4BE}\";\n$tags['#restore#'] = \"\\u{21AA}\";\n$tags['#remove#'] = \"\\u{274C}\";\n\n\/\/ Valeurs par défaut (si non définis en début de scénario)\n(!isset($tags['#nbPluginsGrouped#'])) ? $tags['#nbPluginsGrouped#'] = 50 : null;\n(!isset($tags['#backupPath#'])) ? $tags['#backupPath#'] = \"\/var\/www\/html\/data\/custom\/plugins_backup\" : null;\n(!isset($tags['#pluginsPath#'])) ? $tags['#pluginsPath#'] = \"\/var\/www\/html\/plugins\" : null;\n\n\/\/ ID de la commande \"(N) Notif Général\" d'un équipement du plugin Jeemate\ndefine('MESSAGE_COMMAND_ID', trim($tags['#profile#'], '#'));\n\/\/ Signature des messages envoyés\n$scenarioName = 'Exécuté par le scénario \"' .$scenario->getName().'\"';\ndefine('SCENARIO_NAME', $scenarioName);\n\/\/ Ajout de signature en fin des messages envoyés\ndefine('ADD_SCENARIO_NAME', $tags['#addScenarioName#']);\n\/\/define('SEPARATOR', '<br\/>');\n\/\/define('SEPARATOR', ', ');\ndefine('SEPARATOR', $tags['#separator#']);\n\n\/* Fonctions de manipulations des tableaux de plugins *\/\n\nfunction pluginsFilter ($dirName) {\n  return $dirName != '.' && $dirName != '..';\n}\n\nfunction pluginRenderer($v, $k)\n{\n  \/\/$numberConversion = [':zero:', ':one:', ':two:', ':three:', ':four:', ':five:', ':six:', ':seven:', ':eight:', ':nine:'];\n  \/\/$numberConversion = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9'];\n  \/\/ création du code Emoji\n  $val = $k+1;\n  \/*\n  $pluginNumber = '';\n  while($val!=0) {\n    $mod = $val%10;\n    $pluginNumber = $numberConversion[$mod] . $pluginNumber;\n    $val-=$mod;\n    $val\/=10;\n  }*\/\n\n  \/\/ création du libellé du plugin pour la liste des plugins proposés\n  \/\/return $pluginNumber.' : '.$v;\n  \/\/return \"<b>\".$pluginNumber.\"<\/b>\".' : '.$v;\n  \/\/return \"<b>\".$pluginNumber.' : '.\"<\/b>\".$v;\n  \/\/return \"<span style=\\\"color:#f44010\\\">\".$pluginNumber.\"<\/span>\".\" \".$v;\n  \/\/return \"<span style=\\\\\\\"color:#f44010\\\\\\\">\".$pluginNumber.\"<\/span>\".\" : \".$v.\"<\/span>\";\n  \n  \/\/return \"<b>\".$k.\"<\/b>\".' : '.$v;\n  return $val.' : '.$v;\n}\n\nfunction pluginsConcat($p1,$p2) {\n  return $p1.','.$p2;\n}\n\nfunction createMessage($message, $plugin) {\n  $message .= $plugin . SEPARATOR;\n  return $message;\n}\n\nfunction sendMessage($titre = '', $description = '', $footer = '') {\n  try {\n    $footer = ($footer == '')?SCENARIO_NAME:$footer;\n    if (ADD_SCENARIO_NAME == 1) {\n      $description = $description . \"\\n\\n\" . $footer;\n    }\n    \n    $cmd = cmd::byId(MESSAGE_COMMAND_ID);\n    $options = array('title'=>$titre, 'message'=> $description);\n    $cmd->execCmd($options);\n  }\n  catch(Exception $e){\n    log::add('scenario', 'error', 'Erreur d\\'envoi de message');\n  }\n}\n\nfunction sendPluginsListMessage($msgList) {\n  $msgToSend = trim(array_reduce($msgList, \"createMessage\"), SEPARATOR);\n  try {\n    sendMessage('', $msgToSend);\n  }\n  catch(Exception $e){\n    log::add('scenario', 'error', 'Erreur d\\'envoi de message [Liste de plugins]');\n  }\n}\n\n\/\/ définitions asks, titres, descriptions\n$tags['#askActions#'] = \"Quelle action souhaitez-vous effectuer sur les plugins ?\";\n$tags['#askSauvegarder#'] = \"Quel plugin faut-il sauvegarder ?\".\"\\n\".\"(Saisir le <b><span style='color:#1E90FF'>numéro du plugin<\/span><\/b> souhaité ou <b><span style='color:#1E90FF'>'0'<\/span><\/b> pour 'annuler')\";\n$tags['#askRestaurer#'] = \"Quel plugin souhaitez-vous restaurer ?\".\"\\n\".\"(Saisir le <b><span style='color:#1E90FF'>numéro du plugin<\/span><\/b> souhaité ou <b><span style='color:#1E90FF'>'0'<\/span><\/b> pour 'annuler')\";\n$tags['#askSupprimer#'] = \"Quelle sauvegarde de plugin souhaitez-vous supprimer ?\".\"\\n\".\"(Saisir le <b><span style='color:#1E90FF'>numéro du plugin<\/span><\/b> souhaité ou <b><span style='color:#1E90FF'>'0'<\/span><\/b> pour 'annuler')\";\n\n$tags['#titreSauvegarder#'] = \"Sauvegarde de plugin\";\n$tags['#titreRestaurer#'] = \"Restauration de plugin\";\n$tags['#titreSupprimerSauvegarde#'] = \"Suppression de sauvegarde de plugin\";\n$tags['#titreAnnulerActions#'] = \"Annulation des actions sur plugins\";\n$tags['#titreActionInconnue#'] = \"Action inconnue sur les plugins\";\n$tags['#titreErreurInstallation#'] = \"Erreur à l'installation\";\n  \n$tags['#descriptionSauvegardeAnnulee#'] = $tags['#redCircle#'].\" Sauvegarde de plugin annulée\";\n$tags['#descriptionSauvegardeErreur#'] = $tags['#redCircle#'].\" Erreur de saisie du numéro de plugin\".\"\\n\".\"(numéro invalide ou ne pas saisir le nom du plugin)\";\n$tags['#descriptionRestaurationAucunPlugin#'] = $tags['#redCircle#'].\" Aucun plugin n'est actuellement sauvegardé : <b><span style='color:#ff0000'>restauration impossible<\/span><\/b><br\/><br\/>\";\n$tags['#descriptionRestaurationAnnulee#'] = $tags['#redCircle#'].\" Restauration de plugin annulée\";\n$tags['#descriptionRestaurationErreur#'] = $tags['#redCircle#'].\" Erreur de saisie du numéro de plugin\".\"\\n\".\"(numéro invalide ou ne pas saisir le nom du plugin)\";\n$tags['#descriptionSupprimerSauvegardeAucunPlugin#'] = $tags['#redCircle#'].\" Aucun plugin n'est actuellement sauvegardé :\".\"\\n\".\"<b><span style='color:#ff0000'>suppression<\/span><\/b> de sauvegarde de plugins <b><span style='color:#ff0000'>impossible<\/span><\/b><br\/><br\/>\";\n$tags['#descriptionErreurInstallation#'] = $tags['#redCircle#'].' Vous devez renseigner ces tags en début de scénario :'. \"<br\/><br\/>\"\n\t.\"<b><span style='color:#ff0000'>\"\n  \t.(($tags['#scenarioExecutionActionsPluginsId#'] == -1)?' - scenarioExecutionActionsPluginsId'.\"<br\/>\":'')\n    .(($tags['#scenarioUpdatePluginsId#'] == -1)?' - scenarioUpdatePluginsId'.\"<br\/>\":'')\n    .(($tags['#discordMessageEvolueId#'] == -1)?' - discordMessageEvolueId':'')\n  \t.\"<\/span><\/b><br\/><br\/>\";\n\n$tags['#descriptionSupprimerSauvegardeAnnulee#'] = $tags['#redCircle#'].\" <b><span style='color:#ff0000'>Suppression<\/span><\/b> de sauvegarde de plugin <b><span style='color:#ff0000'>annulée<\/span><\/b>\";\n$tags['#descriptionSupprimerSauvegardeErreur#'] = $tags['#redCircle#'].\" Erreur de saisie du numéro de plugin\".\"\\n\".\"(numéro invalide ou ne pas saisir le nom du plugin)\";\n$tags['#descriptionAnnulerActions#'] = $tags['#redCircle#'].\" Actions sur les plugins <b><span style='color:#ff0000'>annulées<\/span><\/b>\";\n$tags['#descriptionActionInconnue)#'] = $tags['#redCircle#'].\" L'action \\\"variable(askActionOnPlugin)\\\" demandée sur les plugins n'est pas gérée\";\n\nif ($scenario->getRealTrigger() == \"begin_backup\" || $scenario->getRealTrigger() == \"end_backup\") {\n  $tags['#action#'] = $scenario->getRealTrigger();\n  $tags['#plugin#'] = \"Jeedom\";\n}\n\n$scenario->setTags($tags);",
                            "options": [],
                            "order": "0"
                        }
                    ]
                }
            ]
        },
        {
            "name": "",
            "type": "if",
            "options": [],
            "order": "0",
            "subElements": [
                {
                    "name": "",
                    "type": "if",
                    "subtype": "condition",
                    "options": {
                        "collapse": "0",
                        "enable": "1",
                        "allowRepeatCondition": "0"
                    },
                    "order": "0",
                    "expressions": [
                        {
                            "type": "condition",
                            "subtype": "",
                            "expression": "tag(scenarioExecutionActionsPluginsId) == -1 || tag(scenarioUpdatePluginsId) == -1",
                            "options": [],
                            "order": "0"
                        }
                    ]
                },
                {
                    "name": "",
                    "type": "then",
                    "subtype": "action",
                    "options": [],
                    "order": "1",
                    "expressions": [
                        {
                            "type": "element",
                            "subtype": "",
                            "expression": "1448",
                            "options": [],
                            "order": "0",
                            "element": {
                                "name": "",
                                "type": "code",
                                "options": [],
                                "order": "0",
                                "subElements": [
                                    {
                                        "name": "",
                                        "type": "code",
                                        "subtype": "action",
                                        "options": {
                                            "collapse": "0",
                                            "enable": "1"
                                        },
                                        "order": "0",
                                        "expressions": [
                                            {
                                                "type": "code",
                                                "subtype": "",
                                                "expression": "$tags = $scenario->getTags();\nsendMessage($tags['#titreErreurInstallation#'], $tags['#descriptionErreurInstallation#']);",
                                                "options": [],
                                                "order": "0"
                                            }
                                        ]
                                    }
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "",
                    "type": "else",
                    "subtype": "action",
                    "options": [],
                    "order": "2",
                    "expressions": [
                        {
                            "type": "element",
                            "subtype": null,
                            "expression": "1546",
                            "options": [],
                            "order": "0",
                            "element": {
                                "name": null,
                                "type": "if",
                                "options": [],
                                "order": "0",
                                "subElements": [
                                    {
                                        "name": null,
                                        "type": "if",
                                        "subtype": "condition",
                                        "options": {
                                            "collapse": "0",
                                            "enable": "1",
                                            "allowRepeatCondition": "0"
                                        },
                                        "order": "0",
                                        "expressions": [
                                            {
                                                "type": "condition",
                                                "subtype": null,
                                                "expression": "tag(action) == \"begin_backup\" || tag(action) == \"end_backup\"",
                                                "options": [],
                                                "order": "0"
                                            }
                                        ]
                                    },
                                    {
                                        "name": null,
                                        "type": "then",
                                        "subtype": "action",
                                        "options": [],
                                        "order": "1",
                                        "expressions": [
                                            {
                                                "type": "element",
                                                "subtype": null,
                                                "expression": "1547",
                                                "options": [],
                                                "order": "0",
                                                "element": {
                                                    "name": null,
                                                    "type": "code",
                                                    "options": [],
                                                    "order": "0",
                                                    "subElements": [
                                                        {
                                                            "name": null,
                                                            "type": "code",
                                                            "subtype": "action",
                                                            "options": {
                                                                "collapse": "0",
                                                                "enable": "1"
                                                            },
                                                            "order": "0",
                                                            "expressions": [
                                                                {
                                                                    "type": "code",
                                                                    "subtype": null,
                                                                    "expression": "$tags = $scenario->getTags();\n\n$idScenarioExecution = $tags['#scenarioExecutionActionsPluginsId#'];\n$scenarioExecution = scenario::byId($idScenarioExecution);\n\n$paramTags = $scenarioExecution->getTags();\n$paramTags['#action#'] = $tags['#action#'];\n$paramTags['#plugin#'] = 'Jeedom';\n$paramTags['#pluginsPath#'] = $tags['#pluginsPath#'];\n$paramTags['#backupPath#'] = $tags['#backupPath#'];\n$paramTags['#messageCommandId#'] = MESSAGE_COMMAND_ID;\n$paramTags['#addScenarioName#'] = ADD_SCENARIO_NAME;\n\n$scenarioExecution->setTags($paramTags);\n$scenarioExecution->launch();",
                                                                    "options": [],
                                                                    "order": "0"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            }
                                        ]
                                    },
                                    {
                                        "name": null,
                                        "type": "else",
                                        "subtype": "action",
                                        "options": [],
                                        "order": "2",
                                        "expressions": [
                                            {
                                                "type": "element",
                                                "subtype": null,
                                                "expression": "1449",
                                                "options": [],
                                                "order": "0",
                                                "element": {
                                                    "name": "",
                                                    "type": "action",
                                                    "options": [],
                                                    "order": "0",
                                                    "subElements": [
                                                        {
                                                            "name": "",
                                                            "type": "action",
                                                            "subtype": "action",
                                                            "options": {
                                                                "collapse": "0",
                                                                "enable": "1"
                                                            },
                                                            "order": "0",
                                                            "expressions": [
                                                                {
                                                                    "type": "action",
                                                                    "subtype": "",
                                                                    "expression": "ask",
                                                                    "options": {
                                                                        "enable": "1",
                                                                        "background": "0",
                                                                        "question": "tag(askActions)",
                                                                        "answer": "Sauvegarde;Restauration;Mise à jour;Suppression de sauvegarde;Sauvegarde Jeedom;Annuler",
                                                                        "variable": "askActionOnPlugin",
                                                                        "timeout": "60",
                                                                        "cmd": "#profile#"
                                                                    },
                                                                    "order": "0"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            },
                                            {
                                                "type": "element",
                                                "subtype": null,
                                                "expression": "1450",
                                                "options": [],
                                                "order": "1",
                                                "element": {
                                                    "name": "",
                                                    "type": "if",
                                                    "options": [],
                                                    "order": "0",
                                                    "subElements": [
                                                        {
                                                            "name": "",
                                                            "type": "if",
                                                            "subtype": "condition",
                                                            "options": {
                                                                "collapse": "0",
                                                                "enable": "1",
                                                                "allowRepeatCondition": "0"
                                                            },
                                                            "order": "0",
                                                            "expressions": [
                                                                {
                                                                    "type": "condition",
                                                                    "subtype": "",
                                                                    "expression": "strtolower(variable(askActionOnPlugin)) === 'sauvegarde'",
                                                                    "options": [],
                                                                    "order": "0"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "name": "",
                                                            "type": "then",
                                                            "subtype": "action",
                                                            "options": [],
                                                            "order": "1",
                                                            "expressions": [
                                                                {
                                                                    "type": "element",
                                                                    "subtype": "",
                                                                    "expression": "1451",
                                                                    "options": [],
                                                                    "order": "0",
                                                                    "element": {
                                                                        "name": "",
                                                                        "type": "code",
                                                                        "options": [],
                                                                        "order": "0",
                                                                        "subElements": [
                                                                            {
                                                                                "name": "",
                                                                                "type": "code",
                                                                                "subtype": "action",
                                                                                "options": {
                                                                                    "collapse": "0",
                                                                                    "enable": "1"
                                                                                },
                                                                                "order": "0",
                                                                                "expressions": [
                                                                                    {
                                                                                        "type": "code",
                                                                                        "subtype": "",
                                                                                        "expression": "$tags = $scenario->getTags();\n\n\/\/ Demande de backup d'un plugin\n\/\/ Récupération de la liste des plugins installés\n$dirs = array_values(array_filter(scandir($tags['#pluginsPath#']), \"pluginsFilter\"));\n$scenario->setLog('Nombre de plugins installés : ' . sizeof($dirs));\n\n$tags['#installedPluginsList#'] = '';\n$tags['#installedPluginsSize#'] = sizeof($dirs);\nif ($tags['#installedPluginsSize#'] != 0) {\n  $pluginList = array_map('pluginRenderer', $dirs, array_keys($dirs));\n  \/\/ Découpage des plugins par paquets\n  $chunkPluginsList = array_chunk($pluginList, $tags['#nbPluginsGrouped#']);\n  $scenario->setLog('Nombre de messages : ' . sizeof($chunkPluginsList));\n  \/\/ Envoi de la liste des plugins par paquets\n  array_map('sendPluginsListMessage', $chunkPluginsList);\n}\n\n$scenario->setTags($tags);",
                                                                                        "options": [],
                                                                                        "order": "0"
                                                                                    }
                                                                                ]
                                                                            }
                                                                        ]
                                                                    }
                                                                },
                                                                {
                                                                    "type": "action",
                                                                    "subtype": "",
                                                                    "expression": "ask",
                                                                    "options": {
                                                                        "enable": "1",
                                                                        "background": "0",
                                                                        "question": "tag(askSauvegarder)",
                                                                        "answer": "",
                                                                        "variable": "askPluginChoice",
                                                                        "timeout": "60",
                                                                        "cmd": "#profile#"
                                                                    },
                                                                    "order": "1"
                                                                },
                                                                {
                                                                    "type": "element",
                                                                    "subtype": "",
                                                                    "expression": "1452",
                                                                    "options": [],
                                                                    "order": "2",
                                                                    "element": {
                                                                        "name": "",
                                                                        "type": "if",
                                                                        "options": [],
                                                                        "order": "0",
                                                                        "subElements": [
                                                                            {
                                                                                "name": "",
                                                                                "type": "if",
                                                                                "subtype": "condition",
                                                                                "options": {
                                                                                    "collapse": "0",
                                                                                    "enable": "1",
                                                                                    "allowRepeatCondition": "0"
                                                                                },
                                                                                "order": "0",
                                                                                "expressions": [
                                                                                    {
                                                                                        "type": "condition",
                                                                                        "subtype": "",
                                                                                        "expression": "strtolower(variable(askPluginChoice)) === \"aucune réponse\" OU strtolower(variable(askPluginChoice)) === \"annuler\" OU strtolower(variable(askPluginChoice)) === 0",
                                                                                        "options": [],
                                                                                        "order": "0"
                                                                                    }
                                                                                ]
                                                                            },
                                                                            {
                                                                                "name": "",
                                                                                "type": "then",
                                                                                "subtype": "action",
                                                                                "options": [],
                                                                                "order": "1",
                                                                                "expressions": [
                                                                                    {
                                                                                        "type": "element",
                                                                                        "subtype": "",
                                                                                        "expression": "1453",
                                                                                        "options": [],
                                                                                        "order": "0",
                                                                                        "element": {
                                                                                            "name": "",
                                                                                            "type": "code",
                                                                                            "options": [],
                                                                                            "order": "0",
                                                                                            "subElements": [
                                                                                                {
                                                                                                    "name": "",
                                                                                                    "type": "code",
                                                                                                    "subtype": "action",
                                                                                                    "options": {
                                                                                                        "collapse": "0",
                                                                                                        "enable": "1"
                                                                                                    },
                                                                                                    "order": "0",
                                                                                                    "expressions": [
                                                                                                        {
                                                                                                            "type": "code",
                                                                                                            "subtype": "",
                                                                                                            "expression": "$tags = $scenario->getTags();\nsendMessage($tags['#titreSauvegarder#'], $tags['#descriptionSauvegardeAnnulee#']);",
                                                                                                            "options": [],
                                                                                                            "order": "0"
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    }
                                                                                ]
                                                                            },
                                                                            {
                                                                                "name": "",
                                                                                "type": "else",
                                                                                "subtype": "action",
                                                                                "options": [],
                                                                                "order": "2",
                                                                                "expressions": [
                                                                                    {
                                                                                        "type": "element",
                                                                                        "subtype": "",
                                                                                        "expression": "1454",
                                                                                        "options": [],
                                                                                        "order": "0",
                                                                                        "element": {
                                                                                            "name": "",
                                                                                            "type": "code",
                                                                                            "options": [],
                                                                                            "order": "0",
                                                                                            "subElements": [
                                                                                                {
                                                                                                    "name": "",
                                                                                                    "type": "code",
                                                                                                    "subtype": "action",
                                                                                                    "options": {
                                                                                                        "collapse": "0",
                                                                                                        "enable": "1"
                                                                                                    },
                                                                                                    "order": "0",
                                                                                                    "expressions": [
                                                                                                        {
                                                                                                            "type": "code",
                                                                                                            "subtype": "",
                                                                                                            "expression": "$tags = $scenario->getTags();\n\n\/\/ Demande de sauvegarde d'un plugin\n\/\/ Récupération de la liste des plugins installés\n$scenario->setLog('Récupération de la liste des plugins installés dans le répertoire ' . $tags['#pluginsPath']);\n$dirs = array_values(array_filter(scandir($tags['#pluginsPath#']), \"pluginsFilter\"));\n$pluginId = $scenario->getData(\"askPluginChoice\");\n$tags['#pluginToBackup#'] = (is_numeric($pluginId) && $pluginId <= sizeof($dirs)) ? $dirs[$pluginId - 1] : \"\";\n\n$scenario->setLog(\"Lancement du backup du plugin : \" . $tags['#pluginToBackup#']);\n\n$scenario->setTags($tags);",
                                                                                                            "options": [],
                                                                                                            "order": "0"
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    {
                                                                                        "type": "element",
                                                                                        "subtype": "",
                                                                                        "expression": "1455",
                                                                                        "options": [],
                                                                                        "order": "1",
                                                                                        "element": {
                                                                                            "name": "",
                                                                                            "type": "if",
                                                                                            "options": [],
                                                                                            "order": "0",
                                                                                            "subElements": [
                                                                                                {
                                                                                                    "name": "",
                                                                                                    "type": "if",
                                                                                                    "subtype": "condition",
                                                                                                    "options": {
                                                                                                        "collapse": "0",
                                                                                                        "enable": "1",
                                                                                                        "allowRepeatCondition": "0"
                                                                                                    },
                                                                                                    "order": "0",
                                                                                                    "expressions": [
                                                                                                        {
                                                                                                            "type": "condition",
                                                                                                            "subtype": "",
                                                                                                            "expression": "tag(pluginToBackup) === \"\"",
                                                                                                            "options": [],
                                                                                                            "order": "0"
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "name": "",
                                                                                                    "type": "then",
                                                                                                    "subtype": "action",
                                                                                                    "options": [],
                                                                                                    "order": "1",
                                                                                                    "expressions": [
                                                                                                        {
                                                                                                            "type": "element",
                                                                                                            "subtype": "",
                                                                                                            "expression": "1456",
                                                                                                            "options": [],
                                                                                                            "order": "0",
                                                                                                            "element": {
                                                                                                                "name": "",
                                                                                                                "type": "code",
                                                                                                                "options": [],
                                                                                                                "order": "0",
                                                                                                                "subElements": [
                                                                                                                    {
                                                                                                                        "name": "",
                                                                                                                        "type": "code",
                                                                                                                        "subtype": "action",
                                                                                                                        "options": {
                                                                                                                            "collapse": "0",
                                                                                                                            "enable": "1"
                                                                                                                        },
                                                                                                                        "order": "0",
                                                                                                                        "expressions": [
                                                                                                                            {
                                                                                                                                "type": "code",
                                                                                                                                "subtype": "",
                                                                                                                                "expression": "$tags = $scenario->getTags();\nsendMessage($tags['#titreSauvegarder#'], $tags['#descriptionSauvegardeErreur#']);",
                                                                                                                                "options": [],
                                                                                                                                "order": "0"
                                                                                                                            }
                                                                                                                        ]
                                                                                                                    }
                                                                                                                ]
                                                                                                            }
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "name": "",
                                                                                                    "type": "else",
                                                                                                    "subtype": "action",
                                                                                                    "options": [],
                                                                                                    "order": "2",
                                                                                                    "expressions": [
                                                                                                        {
                                                                                                            "type": "element",
                                                                                                            "subtype": "",
                                                                                                            "expression": "1457",
                                                                                                            "options": [],
                                                                                                            "order": "0",
                                                                                                            "element": {
                                                                                                                "name": "",
                                                                                                                "type": "code",
                                                                                                                "options": [],
                                                                                                                "order": "0",
                                                                                                                "subElements": [
                                                                                                                    {
                                                                                                                        "name": "",
                                                                                                                        "type": "code",
                                                                                                                        "subtype": "action",
                                                                                                                        "options": {
                                                                                                                            "collapse": "0",
                                                                                                                            "enable": "1"
                                                                                                                        },
                                                                                                                        "order": "0",
                                                                                                                        "expressions": [
                                                                                                                            {
                                                                                                                                "type": "code",
                                                                                                                                "subtype": "",
                                                                                                                                "expression": "$tags = $scenario->getTags();\n\n$idScenarioExecution = $tags['#scenarioExecutionActionsPluginsId#'];\n$scenarioExecution = scenario::byId($idScenarioExecution);\n\n$paramTags = $scenarioExecution->getTags();\n$paramTags['#action#'] = \"backup\";\n$paramTags['#plugin#'] = $tags['#pluginToBackup#'];\n$paramTags['#pluginsPath#'] = $tags['#pluginsPath#'];\n$paramTags['#backupPath#'] = $tags['#backupPath#'];\n$paramTags['#messageCommandId#'] = MESSAGE_COMMAND_ID;\n$paramTags['#addScenarioName#'] = ADD_SCENARIO_NAME;\n  \n$scenarioExecution->setTags($paramTags);\n$scenarioExecution->launch();",
                                                                                                                                "options": [],
                                                                                                                                "order": "0"
                                                                                                                            }
                                                                                                                        ]
                                                                                                                    }
                                                                                                                ]
                                                                                                            }
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    }
                                                                                ]
                                                                            }
                                                                        ]
                                                                    }
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "name": "",
                                                            "type": "else",
                                                            "subtype": "action",
                                                            "options": [],
                                                            "order": "2",
                                                            "expressions": [
                                                                {
                                                                    "type": "element",
                                                                    "subtype": "",
                                                                    "expression": "1458",
                                                                    "options": [],
                                                                    "order": "0",
                                                                    "element": {
                                                                        "name": "",
                                                                        "type": "if",
                                                                        "options": [],
                                                                        "order": "0",
                                                                        "subElements": [
                                                                            {
                                                                                "name": "",
                                                                                "type": "if",
                                                                                "subtype": "condition",
                                                                                "options": {
                                                                                    "collapse": "0",
                                                                                    "enable": "1",
                                                                                    "allowRepeatCondition": "0"
                                                                                },
                                                                                "order": "0",
                                                                                "expressions": [
                                                                                    {
                                                                                        "type": "condition",
                                                                                        "subtype": "",
                                                                                        "expression": "strtolower(variable(askActionOnPlugin)) === \"restauration\"",
                                                                                        "options": [],
                                                                                        "order": "0"
                                                                                    }
                                                                                ]
                                                                            },
                                                                            {
                                                                                "name": "",
                                                                                "type": "then",
                                                                                "subtype": "action",
                                                                                "options": [],
                                                                                "order": "1",
                                                                                "expressions": [
                                                                                    {
                                                                                        "type": "element",
                                                                                        "subtype": "",
                                                                                        "expression": "1459",
                                                                                        "options": [],
                                                                                        "order": "0",
                                                                                        "element": {
                                                                                            "name": "",
                                                                                            "type": "code",
                                                                                            "options": [],
                                                                                            "order": "0",
                                                                                            "subElements": [
                                                                                                {
                                                                                                    "name": "",
                                                                                                    "type": "code",
                                                                                                    "subtype": "action",
                                                                                                    "options": {
                                                                                                        "collapse": "0",
                                                                                                        "enable": "1"
                                                                                                    },
                                                                                                    "order": "0",
                                                                                                    "expressions": [
                                                                                                        {
                                                                                                            "type": "code",
                                                                                                            "subtype": "",
                                                                                                            "expression": "$tags = $scenario->getTags();\n\n\/\/ Demande de restauration d'un plugin\n\/\/ Récupération de la liste des plugins sauvegardés\n$dirs = array_values(array_filter(scandir($tags['#backupPath#']), \"pluginsFilter\"));\n$scenario->setLog('Nombre de plugins sauvegardés : ' . sizeof($dirs));\n\n$tags['#savedPluginsList#'] = '';\n$tags['#savedPluginsSize#'] = sizeof($dirs);\nif ($tags['#savedPluginsSize#'] != 0) {\n  $pluginList = array_map('pluginRenderer', $dirs, array_keys($dirs));\n  \/\/ Découpage des plugins par paquets\n  $chunkPluginsList = array_chunk($pluginList, $tags['#nbPluginsGrouped#']);\n  $scenario->setLog('Nombre de messages : ' . sizeof($chunkPluginsList));\n  \/\/ Envoi de la liste des plugins par paquets\n  array_map('sendPluginsListMessage', $chunkPluginsList);\n}\n\n$scenario->setTags($tags);",
                                                                                                            "options": [],
                                                                                                            "order": "0"
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    {
                                                                                        "type": "element",
                                                                                        "subtype": "",
                                                                                        "expression": "1460",
                                                                                        "options": [],
                                                                                        "order": "1",
                                                                                        "element": {
                                                                                            "name": "",
                                                                                            "type": "if",
                                                                                            "options": [],
                                                                                            "order": "0",
                                                                                            "subElements": [
                                                                                                {
                                                                                                    "name": "",
                                                                                                    "type": "if",
                                                                                                    "subtype": "condition",
                                                                                                    "options": {
                                                                                                        "collapse": "0",
                                                                                                        "enable": "1",
                                                                                                        "allowRepeatCondition": "0"
                                                                                                    },
                                                                                                    "order": "0",
                                                                                                    "expressions": [
                                                                                                        {
                                                                                                            "type": "condition",
                                                                                                            "subtype": "",
                                                                                                            "expression": "tag(savedPluginsSize) === 0",
                                                                                                            "options": [],
                                                                                                            "order": "0"
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "name": "",
                                                                                                    "type": "then",
                                                                                                    "subtype": "action",
                                                                                                    "options": [],
                                                                                                    "order": "1",
                                                                                                    "expressions": [
                                                                                                        {
                                                                                                            "type": "element",
                                                                                                            "subtype": "",
                                                                                                            "expression": "1461",
                                                                                                            "options": [],
                                                                                                            "order": "0",
                                                                                                            "element": {
                                                                                                                "name": "",
                                                                                                                "type": "code",
                                                                                                                "options": [],
                                                                                                                "order": "0",
                                                                                                                "subElements": [
                                                                                                                    {
                                                                                                                        "name": "",
                                                                                                                        "type": "code",
                                                                                                                        "subtype": "action",
                                                                                                                        "options": {
                                                                                                                            "collapse": "0",
                                                                                                                            "enable": "1"
                                                                                                                        },
                                                                                                                        "order": "0",
                                                                                                                        "expressions": [
                                                                                                                            {
                                                                                                                                "type": "code",
                                                                                                                                "subtype": "",
                                                                                                                                "expression": "$tags = $scenario->getTags();\nsendMessage($tags['#titreRestaurer#'], $tags['#descriptionRestaurationAucunPlugin#']);",
                                                                                                                                "options": [],
                                                                                                                                "order": "0"
                                                                                                                            }
                                                                                                                        ]
                                                                                                                    }
                                                                                                                ]
                                                                                                            }
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "name": "",
                                                                                                    "type": "else",
                                                                                                    "subtype": "action",
                                                                                                    "options": [],
                                                                                                    "order": "2",
                                                                                                    "expressions": [
                                                                                                        {
                                                                                                            "type": "action",
                                                                                                            "subtype": "",
                                                                                                            "expression": "ask",
                                                                                                            "options": {
                                                                                                                "enable": "1",
                                                                                                                "background": "0",
                                                                                                                "question": "tag(askRestaurer)",
                                                                                                                "answer": "",
                                                                                                                "variable": "askPluginToRestore",
                                                                                                                "timeout": "60",
                                                                                                                "cmd": "#profile#"
                                                                                                            },
                                                                                                            "order": "0"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "element",
                                                                                                            "subtype": "",
                                                                                                            "expression": "1462",
                                                                                                            "options": [],
                                                                                                            "order": "1",
                                                                                                            "element": {
                                                                                                                "name": "",
                                                                                                                "type": "if",
                                                                                                                "options": [],
                                                                                                                "order": "0",
                                                                                                                "subElements": [
                                                                                                                    {
                                                                                                                        "name": "",
                                                                                                                        "type": "if",
                                                                                                                        "subtype": "condition",
                                                                                                                        "options": {
                                                                                                                            "collapse": "0",
                                                                                                                            "enable": "1",
                                                                                                                            "allowRepeatCondition": "0"
                                                                                                                        },
                                                                                                                        "order": "0",
                                                                                                                        "expressions": [
                                                                                                                            {
                                                                                                                                "type": "condition",
                                                                                                                                "subtype": "",
                                                                                                                                "expression": "strtolower(variable(askPluginToRestore)) === \"aucune réponse\" OU strtolower(variable(askPluginToRestore)) === \"annuler\" OU strtolower(variable(askPluginToRestore)) === 0",
                                                                                                                                "options": [],
                                                                                                                                "order": "0"
                                                                                                                            }
                                                                                                                        ]
                                                                                                                    },
                                                                                                                    {
                                                                                                                        "name": "",
                                                                                                                        "type": "then",
                                                                                                                        "subtype": "action",
                                                                                                                        "options": [],
                                                                                                                        "order": "1",
                                                                                                                        "expressions": [
                                                                                                                            {
                                                                                                                                "type": "element",
                                                                                                                                "subtype": "",
                                                                                                                                "expression": "1463",
                                                                                                                                "options": [],
                                                                                                                                "order": "0",
                                                                                                                                "element": {
                                                                                                                                    "name": "",
                                                                                                                                    "type": "code",
                                                                                                                                    "options": [],
                                                                                                                                    "order": "0",
                                                                                                                                    "subElements": [
                                                                                                                                        {
                                                                                                                                            "name": "",
                                                                                                                                            "type": "code",
                                                                                                                                            "subtype": "action",
                                                                                                                                            "options": {
                                                                                                                                                "collapse": "0",
                                                                                                                                                "enable": "1"
                                                                                                                                            },
                                                                                                                                            "order": "0",
                                                                                                                                            "expressions": [
                                                                                                                                                {
                                                                                                                                                    "type": "code",
                                                                                                                                                    "subtype": "",
                                                                                                                                                    "expression": "$tags = $scenario->getTags();\nsendMessage($tags['#titreRestaurer#'], $tags['#descriptionRestaurationAnnulee#']);",
                                                                                                                                                    "options": [],
                                                                                                                                                    "order": "0"
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            }
                                                                                                                        ]
                                                                                                                    },
                                                                                                                    {
                                                                                                                        "name": "",
                                                                                                                        "type": "else",
                                                                                                                        "subtype": "action",
                                                                                                                        "options": [],
                                                                                                                        "order": "2",
                                                                                                                        "expressions": [
                                                                                                                            {
                                                                                                                                "type": "element",
                                                                                                                                "subtype": "",
                                                                                                                                "expression": "1464",
                                                                                                                                "options": [],
                                                                                                                                "order": "0",
                                                                                                                                "element": {
                                                                                                                                    "name": "",
                                                                                                                                    "type": "code",
                                                                                                                                    "options": [],
                                                                                                                                    "order": "0",
                                                                                                                                    "subElements": [
                                                                                                                                        {
                                                                                                                                            "name": "",
                                                                                                                                            "type": "code",
                                                                                                                                            "subtype": "action",
                                                                                                                                            "options": {
                                                                                                                                                "collapse": "0",
                                                                                                                                                "enable": "1"
                                                                                                                                            },
                                                                                                                                            "order": "0",
                                                                                                                                            "expressions": [
                                                                                                                                                {
                                                                                                                                                    "type": "code",
                                                                                                                                                    "subtype": "",
                                                                                                                                                    "expression": "$tags = $scenario->getTags();\n\n\/\/ Demande de récupération d'un plugin\n\/\/ Récupération de la liste des plugins sauvegardés\n$scenario->setLog('Récupération de la liste des plugins sauvegardés dans le répertoire ' . $tags['#backupPath#']);\n$dirs = array_values(array_filter(scandir($tags['#backupPath#']), \"pluginsFilter\"));\n$pluginId = $scenario->getData(\"askPluginToRestore\");\n$tags['#pluginToRestore#'] = (is_numeric($pluginId) && $pluginId <= sizeof($dirs)) ? $dirs[$pluginId - 1] : \"\";\n\n$scenario->setLog(\"Lancement de la restauration du plugin \" . $tags['#pluginToRestore#']);\n\n$scenario->setTags($tags);",
                                                                                                                                                    "options": [],
                                                                                                                                                    "order": "0"
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            },
                                                                                                                            {
                                                                                                                                "type": "element",
                                                                                                                                "subtype": "",
                                                                                                                                "expression": "1465",
                                                                                                                                "options": [],
                                                                                                                                "order": "1",
                                                                                                                                "element": {
                                                                                                                                    "name": "",
                                                                                                                                    "type": "if",
                                                                                                                                    "options": [],
                                                                                                                                    "order": "0",
                                                                                                                                    "subElements": [
                                                                                                                                        {
                                                                                                                                            "name": "",
                                                                                                                                            "type": "if",
                                                                                                                                            "subtype": "condition",
                                                                                                                                            "options": {
                                                                                                                                                "collapse": "0",
                                                                                                                                                "enable": "1",
                                                                                                                                                "allowRepeatCondition": "0"
                                                                                                                                            },
                                                                                                                                            "order": "0",
                                                                                                                                            "expressions": [
                                                                                                                                                {
                                                                                                                                                    "type": "condition",
                                                                                                                                                    "subtype": "",
                                                                                                                                                    "expression": "tag(pluginToRestore) === \"\"",
                                                                                                                                                    "options": [],
                                                                                                                                                    "order": "0"
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "name": "",
                                                                                                                                            "type": "then",
                                                                                                                                            "subtype": "action",
                                                                                                                                            "options": [],
                                                                                                                                            "order": "1",
                                                                                                                                            "expressions": [
                                                                                                                                                {
                                                                                                                                                    "type": "element",
                                                                                                                                                    "subtype": "",
                                                                                                                                                    "expression": "1466",
                                                                                                                                                    "options": [],
                                                                                                                                                    "order": "0",
                                                                                                                                                    "element": {
                                                                                                                                                        "name": "",
                                                                                                                                                        "type": "code",
                                                                                                                                                        "options": [],
                                                                                                                                                        "order": "0",
                                                                                                                                                        "subElements": [
                                                                                                                                                            {
                                                                                                                                                                "name": "",
                                                                                                                                                                "type": "code",
                                                                                                                                                                "subtype": "action",
                                                                                                                                                                "options": {
                                                                                                                                                                    "collapse": "0",
                                                                                                                                                                    "enable": "1"
                                                                                                                                                                },
                                                                                                                                                                "order": "0",
                                                                                                                                                                "expressions": [
                                                                                                                                                                    {
                                                                                                                                                                        "type": "code",
                                                                                                                                                                        "subtype": "",
                                                                                                                                                                        "expression": "$tags = $scenario->getTags();\nsendMessage($tags['#titreRestaurer#'], $tags['#descriptionRestaurationErreur#']);",
                                                                                                                                                                        "options": [],
                                                                                                                                                                        "order": "0"
                                                                                                                                                                    }
                                                                                                                                                                ]
                                                                                                                                                            }
                                                                                                                                                        ]
                                                                                                                                                    }
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "name": "",
                                                                                                                                            "type": "else",
                                                                                                                                            "subtype": "action",
                                                                                                                                            "options": [],
                                                                                                                                            "order": "2",
                                                                                                                                            "expressions": [
                                                                                                                                                {
                                                                                                                                                    "type": "element",
                                                                                                                                                    "subtype": "",
                                                                                                                                                    "expression": "1467",
                                                                                                                                                    "options": [],
                                                                                                                                                    "order": "0",
                                                                                                                                                    "element": {
                                                                                                                                                        "name": "",
                                                                                                                                                        "type": "code",
                                                                                                                                                        "options": [],
                                                                                                                                                        "order": "0",
                                                                                                                                                        "subElements": [
                                                                                                                                                            {
                                                                                                                                                                "name": "",
                                                                                                                                                                "type": "code",
                                                                                                                                                                "subtype": "action",
                                                                                                                                                                "options": {
                                                                                                                                                                    "collapse": "0",
                                                                                                                                                                    "enable": "1"
                                                                                                                                                                },
                                                                                                                                                                "order": "0",
                                                                                                                                                                "expressions": [
                                                                                                                                                                    {
                                                                                                                                                                        "type": "code",
                                                                                                                                                                        "subtype": "",
                                                                                                                                                                        "expression": "$tags = $scenario->getTags();\n\n$idScenarioExecution = $tags['#scenarioExecutionActionsPluginsId#'];\n$scenarioExecution = scenario::byId($idScenarioExecution);\n\n$paramTags = $scenarioExecution->getTags();\n$paramTags['#action#'] = \"restore\";\n$paramTags['#plugin#'] = $tags['#pluginToRestore#'];\n$paramTags['#pluginsPath#'] = $tags['#pluginsPath#'];\n$paramTags['#backupPath#'] = $tags['#backupPath#'];\n$paramTags['#messageCommandId#'] = MESSAGE_COMMAND_ID;\n$paramTags['#addScenarioName#'] = ADD_SCENARIO_NAME;\n\n$scenarioExecution->setTags($paramTags);\n$scenarioExecution->launch();",
                                                                                                                                                                        "options": [],
                                                                                                                                                                        "order": "0"
                                                                                                                                                                    }
                                                                                                                                                                ]
                                                                                                                                                            }
                                                                                                                                                        ]
                                                                                                                                                    }
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            }
                                                                                                                        ]
                                                                                                                    }
                                                                                                                ]
                                                                                                            }
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    }
                                                                                ]
                                                                            },
                                                                            {
                                                                                "name": "",
                                                                                "type": "else",
                                                                                "subtype": "action",
                                                                                "options": [],
                                                                                "order": "2",
                                                                                "expressions": [
                                                                                    {
                                                                                        "type": "element",
                                                                                        "subtype": "",
                                                                                        "expression": "1468",
                                                                                        "options": [],
                                                                                        "order": "0",
                                                                                        "element": {
                                                                                            "name": "",
                                                                                            "type": "if",
                                                                                            "options": [],
                                                                                            "order": "0",
                                                                                            "subElements": [
                                                                                                {
                                                                                                    "name": "",
                                                                                                    "type": "if",
                                                                                                    "subtype": "condition",
                                                                                                    "options": {
                                                                                                        "collapse": "0",
                                                                                                        "enable": "1",
                                                                                                        "allowRepeatCondition": "0"
                                                                                                    },
                                                                                                    "order": "0",
                                                                                                    "expressions": [
                                                                                                        {
                                                                                                            "type": "condition",
                                                                                                            "subtype": "",
                                                                                                            "expression": "strtolower(variable(askActionOnPlugin)) === \"mise à jour\"",
                                                                                                            "options": [],
                                                                                                            "order": "0"
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "name": "",
                                                                                                    "type": "then",
                                                                                                    "subtype": "action",
                                                                                                    "options": [],
                                                                                                    "order": "1",
                                                                                                    "expressions": [
                                                                                                        {
                                                                                                            "type": "element",
                                                                                                            "subtype": "",
                                                                                                            "expression": "1469",
                                                                                                            "options": [],
                                                                                                            "order": "0",
                                                                                                            "element": {
                                                                                                                "name": "",
                                                                                                                "type": "code",
                                                                                                                "options": [],
                                                                                                                "order": "0",
                                                                                                                "subElements": [
                                                                                                                    {
                                                                                                                        "name": "",
                                                                                                                        "type": "code",
                                                                                                                        "subtype": "action",
                                                                                                                        "options": {
                                                                                                                            "collapse": "0",
                                                                                                                            "enable": "1"
                                                                                                                        },
                                                                                                                        "order": "0",
                                                                                                                        "expressions": [
                                                                                                                            {
                                                                                                                                "type": "code",
                                                                                                                                "subtype": "",
                                                                                                                                "expression": "$tags = $scenario->getTags();\n$idScenarioUpdatePlugins = $tags['#scenarioUpdatePluginsId#'];\n$scenarioExecution = scenario::byId($idScenarioUpdatePlugins);\n$scenarioExecution->launch();",
                                                                                                                                "options": [],
                                                                                                                                "order": "0"
                                                                                                                            }
                                                                                                                        ]
                                                                                                                    }
                                                                                                                ]
                                                                                                            }
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "name": "",
                                                                                                    "type": "else",
                                                                                                    "subtype": "action",
                                                                                                    "options": [],
                                                                                                    "order": "2",
                                                                                                    "expressions": [
                                                                                                        {
                                                                                                            "type": "element",
                                                                                                            "subtype": "",
                                                                                                            "expression": "1470",
                                                                                                            "options": [],
                                                                                                            "order": "0",
                                                                                                            "element": {
                                                                                                                "name": "",
                                                                                                                "type": "if",
                                                                                                                "options": [],
                                                                                                                "order": "0",
                                                                                                                "subElements": [
                                                                                                                    {
                                                                                                                        "name": "",
                                                                                                                        "type": "if",
                                                                                                                        "subtype": "condition",
                                                                                                                        "options": {
                                                                                                                            "collapse": "0",
                                                                                                                            "enable": "1",
                                                                                                                            "allowRepeatCondition": "0"
                                                                                                                        },
                                                                                                                        "order": "0",
                                                                                                                        "expressions": [
                                                                                                                            {
                                                                                                                                "type": "condition",
                                                                                                                                "subtype": "",
                                                                                                                                "expression": "strtolower(variable(askActionOnPlugin)) === \"suppression de sauvegarde\"",
                                                                                                                                "options": [],
                                                                                                                                "order": "0"
                                                                                                                            }
                                                                                                                        ]
                                                                                                                    },
                                                                                                                    {
                                                                                                                        "name": "",
                                                                                                                        "type": "then",
                                                                                                                        "subtype": "action",
                                                                                                                        "options": [],
                                                                                                                        "order": "1",
                                                                                                                        "expressions": [
                                                                                                                            {
                                                                                                                                "type": "element",
                                                                                                                                "subtype": "",
                                                                                                                                "expression": "1471",
                                                                                                                                "options": [],
                                                                                                                                "order": "0",
                                                                                                                                "element": {
                                                                                                                                    "name": "",
                                                                                                                                    "type": "code",
                                                                                                                                    "options": [],
                                                                                                                                    "order": "0",
                                                                                                                                    "subElements": [
                                                                                                                                        {
                                                                                                                                            "name": "",
                                                                                                                                            "type": "code",
                                                                                                                                            "subtype": "action",
                                                                                                                                            "options": {
                                                                                                                                                "collapse": "0",
                                                                                                                                                "enable": "1"
                                                                                                                                            },
                                                                                                                                            "order": "0",
                                                                                                                                            "expressions": [
                                                                                                                                                {
                                                                                                                                                    "type": "code",
                                                                                                                                                    "subtype": "",
                                                                                                                                                    "expression": "$tags = $scenario->getTags();\n\n\/\/ Récupération de la liste des plugins sauvegardés\n$scenario->setLog('Récupération de la liste des plugins sauvegardés dans le répertoire ' . $tags['#backupPath#']);\n$dirs = array_values(array_filter(scandir($tags['#backupPath#']), \"pluginsFilter\"));\n$scenario->setLog('liste répertoires sauvegardés : ' . $dirs);\n\n$tags['#pluginsToRemoveList#'] = '';\n$tags['#pluginsToRemoveSize#'] = sizeof($dirs);\nif ($tags['#pluginsToRemoveSize#'] != 0) {\n  $pluginList = array_map('pluginRenderer', $dirs, array_keys($dirs));\n  \/\/ Découpage des plugins par paquets\n  $chunkPluginsList = array_chunk($pluginList, $tags['#nbPluginsGrouped#']);\n  $scenario->setLog('Nombre de messages : ' . sizeof($chunkPluginsList));\n  \/\/ Envoi de la liste des plugins par paquets\n  array_map('sendPluginsListMessage', $chunkPluginsList);\n}\n\n$scenario->setTags($tags);",
                                                                                                                                                    "options": [],
                                                                                                                                                    "order": "0"
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            },
                                                                                                                            {
                                                                                                                                "type": "element",
                                                                                                                                "subtype": "",
                                                                                                                                "expression": "1472",
                                                                                                                                "options": [],
                                                                                                                                "order": "1",
                                                                                                                                "element": {
                                                                                                                                    "name": "",
                                                                                                                                    "type": "if",
                                                                                                                                    "options": [],
                                                                                                                                    "order": "0",
                                                                                                                                    "subElements": [
                                                                                                                                        {
                                                                                                                                            "name": "",
                                                                                                                                            "type": "if",
                                                                                                                                            "subtype": "condition",
                                                                                                                                            "options": {
                                                                                                                                                "collapse": "0",
                                                                                                                                                "enable": "1",
                                                                                                                                                "allowRepeatCondition": "0"
                                                                                                                                            },
                                                                                                                                            "order": "0",
                                                                                                                                            "expressions": [
                                                                                                                                                {
                                                                                                                                                    "type": "condition",
                                                                                                                                                    "subtype": "",
                                                                                                                                                    "expression": "tag(pluginsToRemoveSize) === 0",
                                                                                                                                                    "options": [],
                                                                                                                                                    "order": "0"
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "name": "",
                                                                                                                                            "type": "then",
                                                                                                                                            "subtype": "action",
                                                                                                                                            "options": [],
                                                                                                                                            "order": "1",
                                                                                                                                            "expressions": [
                                                                                                                                                {
                                                                                                                                                    "type": "element",
                                                                                                                                                    "subtype": "",
                                                                                                                                                    "expression": "1473",
                                                                                                                                                    "options": [],
                                                                                                                                                    "order": "0",
                                                                                                                                                    "element": {
                                                                                                                                                        "name": "",
                                                                                                                                                        "type": "code",
                                                                                                                                                        "options": [],
                                                                                                                                                        "order": "0",
                                                                                                                                                        "subElements": [
                                                                                                                                                            {
                                                                                                                                                                "name": "",
                                                                                                                                                                "type": "code",
                                                                                                                                                                "subtype": "action",
                                                                                                                                                                "options": {
                                                                                                                                                                    "collapse": "0",
                                                                                                                                                                    "enable": "1"
                                                                                                                                                                },
                                                                                                                                                                "order": "0",
                                                                                                                                                                "expressions": [
                                                                                                                                                                    {
                                                                                                                                                                        "type": "code",
                                                                                                                                                                        "subtype": "",
                                                                                                                                                                        "expression": "$tags = $scenario->getTags();\nsendMessage($tags['#titreSupprimerSauvegarde#'], $tags['#descriptionSupprimerSauvegardeAucunPlugin#']);",
                                                                                                                                                                        "options": [],
                                                                                                                                                                        "order": "0"
                                                                                                                                                                    }
                                                                                                                                                                ]
                                                                                                                                                            }
                                                                                                                                                        ]
                                                                                                                                                    }
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "name": "",
                                                                                                                                            "type": "else",
                                                                                                                                            "subtype": "action",
                                                                                                                                            "options": [],
                                                                                                                                            "order": "2",
                                                                                                                                            "expressions": [
                                                                                                                                                {
                                                                                                                                                    "type": "action",
                                                                                                                                                    "subtype": "",
                                                                                                                                                    "expression": "ask",
                                                                                                                                                    "options": {
                                                                                                                                                        "enable": "1",
                                                                                                                                                        "background": "0",
                                                                                                                                                        "question": "tag(askSupprimer)",
                                                                                                                                                        "answer": "",
                                                                                                                                                        "variable": "askPluginToRemove",
                                                                                                                                                        "timeout": "60",
                                                                                                                                                        "cmd": "#profile#"
                                                                                                                                                    },
                                                                                                                                                    "order": "0"
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "element",
                                                                                                                                                    "subtype": "",
                                                                                                                                                    "expression": "1474",
                                                                                                                                                    "options": [],
                                                                                                                                                    "order": "1",
                                                                                                                                                    "element": {
                                                                                                                                                        "name": "",
                                                                                                                                                        "type": "if",
                                                                                                                                                        "options": [],
                                                                                                                                                        "order": "0",
                                                                                                                                                        "subElements": [
                                                                                                                                                            {
                                                                                                                                                                "name": "",
                                                                                                                                                                "type": "if",
                                                                                                                                                                "subtype": "condition",
                                                                                                                                                                "options": {
                                                                                                                                                                    "collapse": "0",
                                                                                                                                                                    "enable": "1",
                                                                                                                                                                    "allowRepeatCondition": "0"
                                                                                                                                                                },
                                                                                                                                                                "order": "0",
                                                                                                                                                                "expressions": [
                                                                                                                                                                    {
                                                                                                                                                                        "type": "condition",
                                                                                                                                                                        "subtype": "",
                                                                                                                                                                        "expression": "strtolower(variable(askPluginToRemove)) === \"aucune réponse\" OU strtolower(variable(askPluginToRemove)) === \"annuler\" OU strtolower(variable(askPluginToRemove)) === 0",
                                                                                                                                                                        "options": [],
                                                                                                                                                                        "order": "0"
                                                                                                                                                                    }
                                                                                                                                                                ]
                                                                                                                                                            },
                                                                                                                                                            {
                                                                                                                                                                "name": "",
                                                                                                                                                                "type": "then",
                                                                                                                                                                "subtype": "action",
                                                                                                                                                                "options": [],
                                                                                                                                                                "order": "1",
                                                                                                                                                                "expressions": [
                                                                                                                                                                    {
                                                                                                                                                                        "type": "element",
                                                                                                                                                                        "subtype": "",
                                                                                                                                                                        "expression": "1475",
                                                                                                                                                                        "options": [],
                                                                                                                                                                        "order": "0",
                                                                                                                                                                        "element": {
                                                                                                                                                                            "name": "",
                                                                                                                                                                            "type": "code",
                                                                                                                                                                            "options": [],
                                                                                                                                                                            "order": "0",
                                                                                                                                                                            "subElements": [
                                                                                                                                                                                {
                                                                                                                                                                                    "name": "",
                                                                                                                                                                                    "type": "code",
                                                                                                                                                                                    "subtype": "action",
                                                                                                                                                                                    "options": {
                                                                                                                                                                                        "collapse": "0",
                                                                                                                                                                                        "enable": "1"
                                                                                                                                                                                    },
                                                                                                                                                                                    "order": "0",
                                                                                                                                                                                    "expressions": [
                                                                                                                                                                                        {
                                                                                                                                                                                            "type": "code",
                                                                                                                                                                                            "subtype": "",
                                                                                                                                                                                            "expression": "$tags = $scenario->getTags();\nsendMessage($tags['#titreSupprimerSauvegarde#'], $tags['#descriptionSupprimerSauvegardeAnnulee#']);",
                                                                                                                                                                                            "options": [],
                                                                                                                                                                                            "order": "0"
                                                                                                                                                                                        }
                                                                                                                                                                                    ]
                                                                                                                                                                                }
                                                                                                                                                                            ]
                                                                                                                                                                        }
                                                                                                                                                                    }
                                                                                                                                                                ]
                                                                                                                                                            },
                                                                                                                                                            {
                                                                                                                                                                "name": "",
                                                                                                                                                                "type": "else",
                                                                                                                                                                "subtype": "action",
                                                                                                                                                                "options": [],
                                                                                                                                                                "order": "2",
                                                                                                                                                                "expressions": [
                                                                                                                                                                    {
                                                                                                                                                                        "type": "element",
                                                                                                                                                                        "subtype": "",
                                                                                                                                                                        "expression": "1476",
                                                                                                                                                                        "options": [],
                                                                                                                                                                        "order": "0",
                                                                                                                                                                        "element": {
                                                                                                                                                                            "name": "",
                                                                                                                                                                            "type": "code",
                                                                                                                                                                            "options": [],
                                                                                                                                                                            "order": "0",
                                                                                                                                                                            "subElements": [
                                                                                                                                                                                {
                                                                                                                                                                                    "name": "",
                                                                                                                                                                                    "type": "code",
                                                                                                                                                                                    "subtype": "action",
                                                                                                                                                                                    "options": {
                                                                                                                                                                                        "collapse": "0",
                                                                                                                                                                                        "enable": "1"
                                                                                                                                                                                    },
                                                                                                                                                                                    "order": "0",
                                                                                                                                                                                    "expressions": [
                                                                                                                                                                                        {
                                                                                                                                                                                            "type": "code",
                                                                                                                                                                                            "subtype": "",
                                                                                                                                                                                            "expression": "$tags = $scenario->getTags();\n\n\/\/ Demande de suppression d'une sauvegarde de plugin\n\/\/ Récupération de la liste des plugins sauvegardés\n$scenario->setLog('Récupération de la liste des plugins sauvegardés dans le répertoire ' . $tags['#backupPath#']);\n$dirs = array_values(array_filter(scandir($tags['#backupPath#']), \"pluginsFilter\"));\n$pluginId = $scenario->getData(\"askPluginToRemove\");\n$tags['#pluginToRemove#'] = (is_numeric($pluginId) && $pluginId <= sizeof($dirs)) ? $dirs[$pluginId - 1] : \"\";\n\n$scenario->setLog(\"Lancement de la suppression de la sauvegarde du plugin \" . $tags['#pluginToRemove#']);\n\n$scenario->setTags($tags);",
                                                                                                                                                                                            "options": [],
                                                                                                                                                                                            "order": "0"
                                                                                                                                                                                        }
                                                                                                                                                                                    ]
                                                                                                                                                                                }
                                                                                                                                                                            ]
                                                                                                                                                                        }
                                                                                                                                                                    },
                                                                                                                                                                    {
                                                                                                                                                                        "type": "element",
                                                                                                                                                                        "subtype": "",
                                                                                                                                                                        "expression": "1477",
                                                                                                                                                                        "options": [],
                                                                                                                                                                        "order": "1",
                                                                                                                                                                        "element": {
                                                                                                                                                                            "name": "",
                                                                                                                                                                            "type": "if",
                                                                                                                                                                            "options": [],
                                                                                                                                                                            "order": "0",
                                                                                                                                                                            "subElements": [
                                                                                                                                                                                {
                                                                                                                                                                                    "name": "",
                                                                                                                                                                                    "type": "if",
                                                                                                                                                                                    "subtype": "condition",
                                                                                                                                                                                    "options": {
                                                                                                                                                                                        "collapse": "0",
                                                                                                                                                                                        "enable": "1",
                                                                                                                                                                                        "allowRepeatCondition": "0"
                                                                                                                                                                                    },
                                                                                                                                                                                    "order": "0",
                                                                                                                                                                                    "expressions": [
                                                                                                                                                                                        {
                                                                                                                                                                                            "type": "condition",
                                                                                                                                                                                            "subtype": "",
                                                                                                                                                                                            "expression": "tag(pluginToRemove) === \"\"",
                                                                                                                                                                                            "options": [],
                                                                                                                                                                                            "order": "0"
                                                                                                                                                                                        }
                                                                                                                                                                                    ]
                                                                                                                                                                                },
                                                                                                                                                                                {
                                                                                                                                                                                    "name": "",
                                                                                                                                                                                    "type": "then",
                                                                                                                                                                                    "subtype": "action",
                                                                                                                                                                                    "options": [],
                                                                                                                                                                                    "order": "1",
                                                                                                                                                                                    "expressions": [
                                                                                                                                                                                        {
                                                                                                                                                                                            "type": "element",
                                                                                                                                                                                            "subtype": "",
                                                                                                                                                                                            "expression": "1478",
                                                                                                                                                                                            "options": [],
                                                                                                                                                                                            "order": "0",
                                                                                                                                                                                            "element": {
                                                                                                                                                                                                "name": "",
                                                                                                                                                                                                "type": "code",
                                                                                                                                                                                                "options": [],
                                                                                                                                                                                                "order": "0",
                                                                                                                                                                                                "subElements": [
                                                                                                                                                                                                    {
                                                                                                                                                                                                        "name": "",
                                                                                                                                                                                                        "type": "code",
                                                                                                                                                                                                        "subtype": "action",
                                                                                                                                                                                                        "options": {
                                                                                                                                                                                                            "collapse": "0",
                                                                                                                                                                                                            "enable": "1"
                                                                                                                                                                                                        },
                                                                                                                                                                                                        "order": "0",
                                                                                                                                                                                                        "expressions": [
                                                                                                                                                                                                            {
                                                                                                                                                                                                                "type": "code",
                                                                                                                                                                                                                "subtype": "",
                                                                                                                                                                                                                "expression": "$tags = $scenario->getTags();\nsendMessage($tags['#titreSupprimerSauvegarde#'], $tags['#descriptionSupprimerSauvegardeErreur#']);",
                                                                                                                                                                                                                "options": [],
                                                                                                                                                                                                                "order": "0"
                                                                                                                                                                                                            }
                                                                                                                                                                                                        ]
                                                                                                                                                                                                    }
                                                                                                                                                                                                ]
                                                                                                                                                                                            }
                                                                                                                                                                                        }
                                                                                                                                                                                    ]
                                                                                                                                                                                },
                                                                                                                                                                                {
                                                                                                                                                                                    "name": "",
                                                                                                                                                                                    "type": "else",
                                                                                                                                                                                    "subtype": "action",
                                                                                                                                                                                    "options": [],
                                                                                                                                                                                    "order": "2",
                                                                                                                                                                                    "expressions": [
                                                                                                                                                                                        {
                                                                                                                                                                                            "type": "element",
                                                                                                                                                                                            "subtype": "",
                                                                                                                                                                                            "expression": "1479",
                                                                                                                                                                                            "options": [],
                                                                                                                                                                                            "order": "0",
                                                                                                                                                                                            "element": {
                                                                                                                                                                                                "name": "",
                                                                                                                                                                                                "type": "code",
                                                                                                                                                                                                "options": [],
                                                                                                                                                                                                "order": "0",
                                                                                                                                                                                                "subElements": [
                                                                                                                                                                                                    {
                                                                                                                                                                                                        "name": "",
                                                                                                                                                                                                        "type": "code",
                                                                                                                                                                                                        "subtype": "action",
                                                                                                                                                                                                        "options": {
                                                                                                                                                                                                            "collapse": "0",
                                                                                                                                                                                                            "enable": "1"
                                                                                                                                                                                                        },
                                                                                                                                                                                                        "order": "0",
                                                                                                                                                                                                        "expressions": [
                                                                                                                                                                                                            {
                                                                                                                                                                                                                "type": "code",
                                                                                                                                                                                                                "subtype": "",
                                                                                                                                                                                                                "expression": "$tags = $scenario->getTags();\n\n$idScenarioExecution = $tags['#scenarioExecutionActionsPluginsId#'];\n$scenarioExecution = scenario::byId($idScenarioExecution);\n\n$paramTags = $scenarioExecution->getTags();\n$paramTags['#action#'] = \"remove\";\n$paramTags['#plugin#'] = $tags['#pluginToRemove#'];\n$paramTags['#pluginsPath#'] = $tags['#pluginsPath#'];\n$paramTags['#backupPath#'] = $tags['#backupPath#'];\n$paramTags['#messageCommandId#'] = MESSAGE_COMMAND_ID;\n$paramTags['#addScenarioName#'] = ADD_SCENARIO_NAME;\n\n$scenarioExecution->setTags($paramTags);\n$scenarioExecution->launch();",
                                                                                                                                                                                                                "options": [],
                                                                                                                                                                                                                "order": "0"
                                                                                                                                                                                                            }
                                                                                                                                                                                                        ]
                                                                                                                                                                                                    }
                                                                                                                                                                                                ]
                                                                                                                                                                                            }
                                                                                                                                                                                        }
                                                                                                                                                                                    ]
                                                                                                                                                                                }
                                                                                                                                                                            ]
                                                                                                                                                                        }
                                                                                                                                                                    }
                                                                                                                                                                ]
                                                                                                                                                            }
                                                                                                                                                        ]
                                                                                                                                                    }
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            }
                                                                                                                        ]
                                                                                                                    },
                                                                                                                    {
                                                                                                                        "name": "",
                                                                                                                        "type": "else",
                                                                                                                        "subtype": "action",
                                                                                                                        "options": [],
                                                                                                                        "order": "2",
                                                                                                                        "expressions": [
                                                                                                                            {
                                                                                                                                "type": "element",
                                                                                                                                "subtype": "",
                                                                                                                                "expression": "1480",
                                                                                                                                "options": [],
                                                                                                                                "order": "0",
                                                                                                                                "element": {
                                                                                                                                    "name": "",
                                                                                                                                    "type": "if",
                                                                                                                                    "options": [],
                                                                                                                                    "order": "0",
                                                                                                                                    "subElements": [
                                                                                                                                        {
                                                                                                                                            "name": "",
                                                                                                                                            "type": "if",
                                                                                                                                            "subtype": "condition",
                                                                                                                                            "options": {
                                                                                                                                                "collapse": "0",
                                                                                                                                                "enable": "1",
                                                                                                                                                "allowRepeatCondition": "0"
                                                                                                                                            },
                                                                                                                                            "order": "0",
                                                                                                                                            "expressions": [
                                                                                                                                                {
                                                                                                                                                    "type": "condition",
                                                                                                                                                    "subtype": "",
                                                                                                                                                    "expression": "strtolower(variable(askActionOnPlugin)) === \"sauvegarde jeedom\"",
                                                                                                                                                    "options": [],
                                                                                                                                                    "order": "0"
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "name": "",
                                                                                                                                            "type": "then",
                                                                                                                                            "subtype": "action",
                                                                                                                                            "options": [],
                                                                                                                                            "order": "1",
                                                                                                                                            "expressions": [
                                                                                                                                                {
                                                                                                                                                    "type": "element",
                                                                                                                                                    "subtype": "",
                                                                                                                                                    "expression": "1481",
                                                                                                                                                    "options": [],
                                                                                                                                                    "order": "0",
                                                                                                                                                    "element": {
                                                                                                                                                        "name": "",
                                                                                                                                                        "type": "code",
                                                                                                                                                        "options": [],
                                                                                                                                                        "order": "0",
                                                                                                                                                        "subElements": [
                                                                                                                                                            {
                                                                                                                                                                "name": "",
                                                                                                                                                                "type": "code",
                                                                                                                                                                "subtype": "action",
                                                                                                                                                                "options": {
                                                                                                                                                                    "collapse": "0",
                                                                                                                                                                    "enable": "1"
                                                                                                                                                                },
                                                                                                                                                                "order": "0",
                                                                                                                                                                "expressions": [
                                                                                                                                                                    {
                                                                                                                                                                        "type": "code",
                                                                                                                                                                        "subtype": "",
                                                                                                                                                                        "expression": "$tags = $scenario->getTags();\n\n$idScenarioExecution = $tags['#scenarioExecutionActionsPluginsId#'];\n$scenarioExecution = scenario::byId($idScenarioExecution);\n\n$paramTags = $scenarioExecution->getTags();\n$paramTags['#action#'] = \"backup\";\n$paramTags['#plugin#'] = \"Jeedom\";\n$paramTags['#messageCommandId#'] = MESSAGE_COMMAND_ID;\n$paramTags['#addScenarioName#'] = ADD_SCENARIO_NAME;\n\n$scenarioExecution->setTags($paramTags);\n$scenarioExecution->launch();",
                                                                                                                                                                        "options": [],
                                                                                                                                                                        "order": "0"
                                                                                                                                                                    }
                                                                                                                                                                ]
                                                                                                                                                            }
                                                                                                                                                        ]
                                                                                                                                                    }
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "name": "",
                                                                                                                                            "type": "else",
                                                                                                                                            "subtype": "action",
                                                                                                                                            "options": [],
                                                                                                                                            "order": "2",
                                                                                                                                            "expressions": [
                                                                                                                                                {
                                                                                                                                                    "type": "element",
                                                                                                                                                    "subtype": "",
                                                                                                                                                    "expression": "1482",
                                                                                                                                                    "options": [],
                                                                                                                                                    "order": "0",
                                                                                                                                                    "element": {
                                                                                                                                                        "name": "",
                                                                                                                                                        "type": "if",
                                                                                                                                                        "options": [],
                                                                                                                                                        "order": "0",
                                                                                                                                                        "subElements": [
                                                                                                                                                            {
                                                                                                                                                                "name": "",
                                                                                                                                                                "type": "if",
                                                                                                                                                                "subtype": "condition",
                                                                                                                                                                "options": {
                                                                                                                                                                    "collapse": "0",
                                                                                                                                                                    "enable": "1",
                                                                                                                                                                    "allowRepeatCondition": "0"
                                                                                                                                                                },
                                                                                                                                                                "order": "0",
                                                                                                                                                                "expressions": [
                                                                                                                                                                    {
                                                                                                                                                                        "type": "condition",
                                                                                                                                                                        "subtype": "",
                                                                                                                                                                        "expression": "strtolower(variable(askActionOnPlugin)) === \"aucune réponse\" OU strtolower(variable(askActionOnPlugin)) === \"annuler\" OU strtolower(variable(askActionOnPlugin)) === 0",
                                                                                                                                                                        "options": [],
                                                                                                                                                                        "order": "0"
                                                                                                                                                                    }
                                                                                                                                                                ]
                                                                                                                                                            },
                                                                                                                                                            {
                                                                                                                                                                "name": "",
                                                                                                                                                                "type": "then",
                                                                                                                                                                "subtype": "action",
                                                                                                                                                                "options": [],
                                                                                                                                                                "order": "1",
                                                                                                                                                                "expressions": [
                                                                                                                                                                    {
                                                                                                                                                                        "type": "element",
                                                                                                                                                                        "subtype": "",
                                                                                                                                                                        "expression": "1483",
                                                                                                                                                                        "options": [],
                                                                                                                                                                        "order": "0",
                                                                                                                                                                        "element": {
                                                                                                                                                                            "name": "",
                                                                                                                                                                            "type": "code",
                                                                                                                                                                            "options": [],
                                                                                                                                                                            "order": "0",
                                                                                                                                                                            "subElements": [
                                                                                                                                                                                {
                                                                                                                                                                                    "name": "",
                                                                                                                                                                                    "type": "code",
                                                                                                                                                                                    "subtype": "action",
                                                                                                                                                                                    "options": {
                                                                                                                                                                                        "collapse": "0",
                                                                                                                                                                                        "enable": "1"
                                                                                                                                                                                    },
                                                                                                                                                                                    "order": "0",
                                                                                                                                                                                    "expressions": [
                                                                                                                                                                                        {
                                                                                                                                                                                            "type": "code",
                                                                                                                                                                                            "subtype": "",
                                                                                                                                                                                            "expression": "$tags = $scenario->getTags();\nsendMessage($tags['#titreAnnulerActions#'], $tags['#descriptionAnnulerActions#']);",
                                                                                                                                                                                            "options": [],
                                                                                                                                                                                            "order": "0"
                                                                                                                                                                                        }
                                                                                                                                                                                    ]
                                                                                                                                                                                }
                                                                                                                                                                            ]
                                                                                                                                                                        }
                                                                                                                                                                    }
                                                                                                                                                                ]
                                                                                                                                                            },
                                                                                                                                                            {
                                                                                                                                                                "name": "",
                                                                                                                                                                "type": "else",
                                                                                                                                                                "subtype": "action",
                                                                                                                                                                "options": [],
                                                                                                                                                                "order": "2",
                                                                                                                                                                "expressions": [
                                                                                                                                                                    {
                                                                                                                                                                        "type": "element",
                                                                                                                                                                        "subtype": "",
                                                                                                                                                                        "expression": "1484",
                                                                                                                                                                        "options": [],
                                                                                                                                                                        "order": "0",
                                                                                                                                                                        "element": {
                                                                                                                                                                            "name": "",
                                                                                                                                                                            "type": "code",
                                                                                                                                                                            "options": [],
                                                                                                                                                                            "order": "0",
                                                                                                                                                                            "subElements": [
                                                                                                                                                                                {
                                                                                                                                                                                    "name": "",
                                                                                                                                                                                    "type": "code",
                                                                                                                                                                                    "subtype": "action",
                                                                                                                                                                                    "options": {
                                                                                                                                                                                        "collapse": "0",
                                                                                                                                                                                        "enable": "1"
                                                                                                                                                                                    },
                                                                                                                                                                                    "order": "0",
                                                                                                                                                                                    "expressions": [
                                                                                                                                                                                        {
                                                                                                                                                                                            "type": "code",
                                                                                                                                                                                            "subtype": "",
                                                                                                                                                                                            "expression": "$tags = $scenario->getTags();\nsendMessage($tags['#titreActionInconnue#'], $tags['#descriptionActionInconnue#']);",
                                                                                                                                                                                            "options": [],
                                                                                                                                                                                            "order": "0"
                                                                                                                                                                                        }
                                                                                                                                                                                    ]
                                                                                                                                                                                }
                                                                                                                                                                            ]
                                                                                                                                                                        }
                                                                                                                                                                    }
                                                                                                                                                                ]
                                                                                                                                                            }
                                                                                                                                                        ]
                                                                                                                                                    }
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            }
                                                                                                                        ]
                                                                                                                    }
                                                                                                                ]
                                                                                                            }
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    }
                                                                                ]
                                                                            }
                                                                        ]
                                                                    }
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            }
                                        ]
                                    }
                                ]
                            }
                        }
                    ]
                }
            ]
        }
    ]
}