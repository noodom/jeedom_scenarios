{
    "name": "Demande d actions sur plugins",
    "isActive": "1",
    "group": "Gestion Plugins",
    "mode": "provoke",
    "schedule": "",
    "trigger": [
        "strtolower(#[Notifications][Discord - Infos][Dernier message]# ) == \"backup\"",
        "strtolower(#[Notifications][Discord - Infos][Dernier message]# ) == \"backups\""
    ],
    "timeout": "0",
    "isVisible": "0",
    "display": {
        "name": "",
        "icon": ""
    },
    "order": "9999",
    "description": "",
    "configuration": {
        "timeDependency": 0,
        "has_return": 0,
        "logmode": "default",
        "allowMultiInstance": "0",
        "syncmode": "0",
        "timeline::enable": "0",
        "timeline::folder": ""
    },
    "state": "stop",
    "elements": [
        {
            "name": null,
            "type": "code",
            "options": [],
            "order": "0",
            "subElements": [
                {
                    "name": null,
                    "type": "code",
                    "subtype": "action",
                    "options": {
                        "collapse": "0",
                        "enable": "1"
                    },
                    "order": "0",
                    "expressions": [
                        {
                            "type": "code",
                            "subtype": null,
                            "expression": "\/* @noodom \/ Scénario de gestion des plugins Jeedom depuis Discord (Sauvegarde, Restauration, Mise à jour, Suppression de sauvegardes)\nNom du scénario : Demande d actions sur plugins\n\nInstallation du menu : https:\/\/github.com\/noodom\/jeedom_scenarios\/blob\/master\/updatePlugins\/README.md\n- Menu des actions possibles sur les plugins\n- Exécute les actions demandées par l'utilisateur avec l'appel du scénario \"Exécution d actions sur plugins\"\n\n\/!\\ ATTENTION \/!\\ Ce scénario modifie le contenu du répertoires contenant les plugins Jeedom. \n\/!\\ Je vous laisse seul juge de la pertinence et de votre confiance à utiliser ce scénario pour la gestion de l'installation de vos plugins.\n\/!\\ Je décline donc toute responsabilité pour tout problème créé suite à l'exécution de ce scénario.\/!\\ \n\n\/!\\ Réactiver les 4 commandes \"scenario\" et sélectionner les scénario \"Exécution d actions sur plugins\" et \"update plugins\" (voir les commentaires avant les commandes)\n\/!\\ Définir l'identifiant de la commande \"Envoi message évolué\" de l'équipement Discord utilisé avec la valeur de DISCORD_MESSAGE_EVOLUE_ID dans les modifications ci-dessous\n\/!\\ Définir le nombre de plugins contenus dans chaque groupe de plugins affichés avec la valeur de NB_PLUGINS_GROUPED dans les modifications ci-dessous\n\/!\\ Définir le répertoire contenant la liste des plugins installés avec la valeur de pluginsPath dans les modifications ci-dessous (pas de raison de le modifier à priori)\n\/!\\ Définir le répertoire de sauvegarde des plugins utilisé par ce scénario avec la valeur de  backupPath dans les modifications ci-dessous\n\nReporter les modifications de pluginsPath et backupPath dans le scénario \"Exécution d actions sur plugins\"\n\n*\/\n\n$scenario->setLog('Lancement des actions sur les plugins');\n\n$tags = $scenario->getTags();\n\n\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\n\/\/ DEBUT DES MODIFICATIONS\n\/\/\n\n\/\/ BIEN LIRE LE BLOC COMMENTAIRE CI-DESSUS AVANT UTILISATION !\n\n\/\/ ID de la commande \"Envoi message évolué\" d'un équipement du plugin Discord\ndefine('DISCORD_MESSAGE_EVOLUE_ID', 12737);\n\/\/ Nombre de plugins pour chaque groupe de la liste des plugins affichés\ndefine('NB_PLUGINS_GROUPED', 50);\n\n\/\/ Définition des répertoires\n\/\/ - Répertoire des plugins Jeedom\n\/\/$tags['#pluginsPath#'] = '\/var\/www\/html\/data\/custom\/plugins_backup\/origin';\n$tags['#pluginsPath#'] = \"\/var\/www\/html\/plugins\";\n\/\/ - Répertoire de sauvegarde des plugins\n\/\/$tags['#backupPath#'] = '\/var\/www\/html\/data\/custom\/plugins_backup\/destination';\n$tags['#backupPath#'] = \"\/var\/www\/html\/data\/custom\/plugins_backup\";\n\n\/\/ Signature du scénario pour messages Discord\n$tags['#scenarioName#'] = 'Exécuté par : ' . $scenario->getName();\n\n\/\/\n\/\/ FIN DES MODIFICATIONS\n\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\n\n\/* Fonctions de manipulations des tableaux de plugins *\/\n\nfunction pluginsFilter ($dirName) {\n  return $dirName != '.' && $dirName != '..';\n}\n\nfunction pluginRenderer($v, $k)\n{\n  $numberConversion = [':zero:', ':one:', ':two:', ':three:', ':four:', ':five:', ':six:', ':seven:', ':eight:', ':nine:'];\n  \/\/ création du code Emoji\n  $val = $k+1;\n  $pluginNumber = '';\n  while($val!=0) {\n    $mod = $val%10;\n    $pluginNumber = $numberConversion[$mod] . $pluginNumber;\n    $val-=$mod;\n    $val\/=10;\n  }\n\n  \/\/ création du libellé du plugin pour la liste des plugins proposés\n  return $pluginNumber.' : '.$v;\n}\n\nfunction pluginsConcat($p1,$p2) {\n  return $p1.','.$p2;\n}\n\nfunction createMessage($message, $plugin) {\n  $message .= $plugin . ' , ';\n  return $message;\n}\n\nfunction sendMessage($msgList) {\n  $msgToSend = array_reduce($msgList, \"createMessage\");\n  try {\n    $cmd = cmd::byId(DISCORD_MESSAGE_EVOLUE_ID);\n    $options = array('titre'=>'', 'description'=> $msgToSend, 'colors'=> '#0000FF', 'footer'=> '');\n    $cmd->execCmd($options);\n  }\n  catch(Exception $e){\n    log::add('scenario', 'error', 'Erreur d\\'envoi de message Discord [Liste de plugins]');\n  }\n}\n\n\/\/ définitions asks, titres, descriptions\n$tags['#askActions#'] = \"Quelle action souhaitez-vous effectuer sur les plugins ?\";\n$tags['#askSauvegarder#'] = \"Quel plugin faut-il sauvegarder ?\".\"\\n\".\"(Saisir le numéro du plugin souhaité ou 'annuler')\";\n$tags['#askRestaurer#'] = \"Quel plugin souhaitez-vous restaurer ?\".\"\\n\".\"(Saisir le numéro du plugin souhaité ou 'annuler')\";\n$tags['#askSupprimer#'] = \"Quel plugin souhaitez-vous supprimer ?\".\"\\n\".\"(Saisir le numéro du plugin souhaité ou 'annuler')\";\n\n$tags['#titreSauvegarder#'] = \"Sauvegarde de plugin\";\n$tags['#titreRestaurer#'] = \"Restauration de plugin\";\n$tags['#titreSupprimerSauvegarde#'] = \"Suppression de sauvegarde de plugin\";\n$tags['#titreAnnulerActions#'] = \"Annulation des actions sur plugins\";\n$tags['#titreActionInconnue#'] = \"Action inconnue sur les plugins\";\n\n$tags['#descriptionSauvegardeAnnulee#'] = \":red_circle: Sauvegarde de plugin annulée\";\n$tags['#descriptionSauvegardeErreur#'] = \":red_circle: Erreur de saisie du numéro de plugin\".\"\\n\".\"(numéro invalide ou ne pas saisir le nom du plugin)\";\n$tags['#descriptionRestaurationAucunPlugin#'] = \":red_circle: Aucun plugin n'est actuellement sauvegardé : restauration impossible\";\n$tags['#descriptionRestaurationAnnulee#'] = \":red_circle: Restauration de plugin annulée\";\n$tags['#descriptionRestaurationErreur#'] = \":red_circle: Erreur de saisie du numéro de plugin\".\"\\n\".\"(numéro invalide ou ne pas saisir le nom du plugin)\";\n$tags['#descriptionSupprimerSauvegardeAucunPlugin#'] = \":red_circle: Aucun plugin n'est actuellement sauvegardé :\".\"\\n\".\"suppression de sauvegarde de plugins impossible\";\n\n$tags['#descriptionSupprimerSauvegardeAnnulee#'] = \":red_circle: Suppression de sauvegarde de plugin annulée\";\n$tags['#descriptionSupprimerSauvegardeErreur#'] = \":red_circle: Erreur de saisie du numéro de plugin\".\"\\n\".\"(numéro invalide ou ne pas saisir le nom du plugin)\";\n$tags['#descriptionAnnulerActions#'] = \":red_circle: Actions sur les plugins annulées\";\n$tags['#descriptionActionInconnue)#'] = \":red_circle: L'action \\\"variable(askActionOnPlugin)\\\" demandée sur les plugins n'est pas gérée\";\n\n$scenario->setTags($tags);",
                            "options": [],
                            "order": "0"
                        }
                    ]
                }
            ]
        },
        {
            "name": null,
            "type": "action",
            "options": [],
            "order": "0",
            "subElements": [
                {
                    "name": null,
                    "type": "action",
                    "subtype": "action",
                    "options": {
                        "collapse": "0",
                        "enable": "1"
                    },
                    "order": "0",
                    "expressions": [
                        {
                            "type": "action",
                            "subtype": null,
                            "expression": "ask",
                            "options": {
                                "enable": "1",
                                "background": "0",
                                "question": "tag(askActions)",
                                "answer": "Sauvegarde;Restauration;Mise à jour;Suppression de sauvegarde;Annuler",
                                "variable": "askActionOnPlugin",
                                "timeout": "60",
                                "cmd": "#[Notifications][Discord - Infos][Envoi message évolué]#"
                            },
                            "order": "0"
                        }
                    ]
                }
            ]
        },
        {
            "name": null,
            "type": "if",
            "options": [],
            "order": "0",
            "subElements": [
                {
                    "name": null,
                    "type": "if",
                    "subtype": "condition",
                    "options": {
                        "collapse": "0",
                        "enable": "1",
                        "allowRepeatCondition": "0"
                    },
                    "order": "0",
                    "expressions": [
                        {
                            "type": "condition",
                            "subtype": null,
                            "expression": "strtolower(variable(askActionOnPlugin)) == 'sauvegarde'",
                            "options": [],
                            "order": "0"
                        }
                    ]
                },
                {
                    "name": null,
                    "type": "then",
                    "subtype": "action",
                    "options": [],
                    "order": "1",
                    "expressions": [
                        {
                            "type": "element",
                            "subtype": null,
                            "expression": "1177",
                            "options": [],
                            "order": "0",
                            "element": {
                                "name": null,
                                "type": "code",
                                "options": [],
                                "order": "0",
                                "subElements": [
                                    {
                                        "name": null,
                                        "type": "code",
                                        "subtype": "action",
                                        "options": {
                                            "collapse": "0",
                                            "enable": "1"
                                        },
                                        "order": "0",
                                        "expressions": [
                                            {
                                                "type": "code",
                                                "subtype": null,
                                                "expression": "$tags = $scenario->getTags();\n\n\/\/ Demande de backup d'un plugin\n\/\/ Récupération de la liste des plugins installés\n$dirs = array_values(array_filter(scandir($tags['#pluginsPath#']), \"pluginsFilter\"));\n$scenario->setLog('Nombre de plugins installés : ' . sizeof($dirs));\n\n$tags['#installedPluginsList#'] = '';\n$tags['#installedPluginsSize#'] = sizeof($dirs);\nif ($tags['#installedPluginsSize#'] != 0) {\n  $pluginList = array_map('pluginRenderer', $dirs, array_keys($dirs));\n  \/\/ Découpages des plugins par paquets de 10\n  $chunkPluginsList = array_chunk($pluginList, NB_PLUGINS_GROUPED);\n  $scenario->setLog('Nombre de messages : ' . sizeof($chunkPluginsList));\n  \/\/ Envoi de la liste des plugins par paquets\n  array_map('sendMessage', $chunkPluginsList);\n}\n\n\/*\n$listPlugins = \"\";\nforeach (plugin::listPlugin(true) as $plugin) {\n    $plugin_id = $plugin->getId();\n    $scenario->setLog('- plugin installé : ' . $plugin_id);\n\t$listPlugins .= $plugin_id.\";\";\n}\n$listPlugins .= \"Annuler\";\n$scenario->setLog('Sauvegarde la liste des plugins installés');\n$tags['#listPluginsInstalles#'] = $listPlugins;\n*\/\n\n$scenario->setTags($tags);",
                                                "options": [],
                                                "order": "0"
                                            }
                                        ]
                                    }
                                ]
                            }
                        },
                        {
                            "type": "action",
                            "subtype": null,
                            "expression": "ask",
                            "options": {
                                "enable": "1",
                                "background": "0",
                                "question": "tag(askSauvegarder)",
                                "answer": "",
                                "variable": "askPluginChoice",
                                "timeout": "60",
                                "cmd": "#[Notifications][Discord - Infos][Envoi message évolué]#"
                            },
                            "order": "1"
                        },
                        {
                            "type": "element",
                            "subtype": null,
                            "expression": "1178",
                            "options": [],
                            "order": "2",
                            "element": {
                                "name": null,
                                "type": "if",
                                "options": [],
                                "order": "0",
                                "subElements": [
                                    {
                                        "name": null,
                                        "type": "if",
                                        "subtype": "condition",
                                        "options": {
                                            "collapse": "0",
                                            "enable": "1",
                                            "allowRepeatCondition": "0"
                                        },
                                        "order": "0",
                                        "expressions": [
                                            {
                                                "type": "condition",
                                                "subtype": null,
                                                "expression": "strtolower(variable(askPluginChoice)) == \"aucune réponse\" OU strtolower(variable(askPluginChoice)) == \"annuler\"",
                                                "options": [],
                                                "order": "0"
                                            }
                                        ]
                                    },
                                    {
                                        "name": null,
                                        "type": "then",
                                        "subtype": "action",
                                        "options": [],
                                        "order": "1",
                                        "expressions": [
                                            {
                                                "type": "action",
                                                "subtype": null,
                                                "expression": "#[Notifications][Discord - Infos][Envoi message évolué]#",
                                                "options": {
                                                    "enable": "1",
                                                    "background": "0",
                                                    "Titre": "tag(titreSauvegarder)",
                                                    "url": "",
                                                    "description": "tag(descriptionSauvegardeAnnulee)",
                                                    "footer": "tag(scenarioName)",
                                                    "colors": "#ff0000"
                                                },
                                                "order": "0"
                                            }
                                        ]
                                    },
                                    {
                                        "name": null,
                                        "type": "else",
                                        "subtype": "action",
                                        "options": [],
                                        "order": "2",
                                        "expressions": [
                                            {
                                                "type": "element",
                                                "subtype": null,
                                                "expression": "1179",
                                                "options": [],
                                                "order": "0",
                                                "element": {
                                                    "name": null,
                                                    "type": "code",
                                                    "options": [],
                                                    "order": "0",
                                                    "subElements": [
                                                        {
                                                            "name": null,
                                                            "type": "code",
                                                            "subtype": "action",
                                                            "options": {
                                                                "collapse": "0",
                                                                "enable": "1"
                                                            },
                                                            "order": "0",
                                                            "expressions": [
                                                                {
                                                                    "type": "code",
                                                                    "subtype": null,
                                                                    "expression": "$tags = $scenario->getTags();\n\n\/\/ Demande de sauvegarde d'un plugin\n\/\/ Récupération de la liste des plugins installés\n$scenario->setLog('Récupération de la liste des plugins installés dans le répertoire ' . $tags['#pluginsPath']);\n$dirs = array_values(array_filter(scandir($tags['#pluginsPath#']), \"pluginsFilter\"));\n$pluginId = $scenario->getData(\"askPluginChoice\");\n$tags['#pluginToBackup#'] = (is_numeric($pluginId) && $pluginId <= sizeof($dirs)) ? $dirs[$pluginId - 1] : \"\";\n\n$scenario->setLog(\"Lancement du backup du plugin \" . $tags['#pluginToBackup#']);\n\n$scenario->setTags($tags);",
                                                                    "options": [],
                                                                    "order": "0"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            },
                                            {
                                                "type": "element",
                                                "subtype": null,
                                                "expression": "1180",
                                                "options": [],
                                                "order": "1",
                                                "element": {
                                                    "name": null,
                                                    "type": "if",
                                                    "options": [],
                                                    "order": "0",
                                                    "subElements": [
                                                        {
                                                            "name": null,
                                                            "type": "if",
                                                            "subtype": "condition",
                                                            "options": {
                                                                "collapse": "0",
                                                                "enable": "1",
                                                                "allowRepeatCondition": "0"
                                                            },
                                                            "order": "0",
                                                            "expressions": [
                                                                {
                                                                    "type": "condition",
                                                                    "subtype": null,
                                                                    "expression": "tag(pluginToBackup) == \"\"",
                                                                    "options": [],
                                                                    "order": "0"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "name": null,
                                                            "type": "then",
                                                            "subtype": "action",
                                                            "options": [],
                                                            "order": "1",
                                                            "expressions": [
                                                                {
                                                                    "type": "action",
                                                                    "subtype": null,
                                                                    "expression": "#[Notifications][Discord - Infos][Envoi message évolué]#",
                                                                    "options": {
                                                                        "enable": "1",
                                                                        "background": "0",
                                                                        "Titre": "tag(titreSauvegarder)",
                                                                        "url": "",
                                                                        "description": "tag(descriptionSauvegardeErreur)",
                                                                        "footer": "tag(scenarioName)",
                                                                        "colors": "#ff0000"
                                                                    },
                                                                    "order": "0"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "name": null,
                                                            "type": "else",
                                                            "subtype": "action",
                                                            "options": [],
                                                            "order": "2",
                                                            "expressions": [
                                                                {
                                                                    "type": "element",
                                                                    "subtype": null,
                                                                    "expression": "1227",
                                                                    "options": [],
                                                                    "order": "0",
                                                                    "element": {
                                                                        "name": null,
                                                                        "type": "comment",
                                                                        "options": [],
                                                                        "order": "0",
                                                                        "subElements": [
                                                                            {
                                                                                "name": null,
                                                                                "type": "comment",
                                                                                "subtype": "comment",
                                                                                "options": {
                                                                                    "collapse": "0"
                                                                                },
                                                                                "order": "0",
                                                                                "expressions": [
                                                                                    {
                                                                                        "type": "comment",
                                                                                        "subtype": null,
                                                                                        "expression": "- réactiver la commande scénario\n- sélectionner le scénario \"Exécution d actions sur plugins\"",
                                                                                        "options": [],
                                                                                        "order": "0"
                                                                                    }
                                                                                ]
                                                                            }
                                                                        ]
                                                                    }
                                                                },
                                                                {
                                                                    "type": "action",
                                                                    "subtype": null,
                                                                    "expression": "scenario",
                                                                    "options": {
                                                                        "enable": "0",
                                                                        "background": "0",
                                                                        "scenario_id": "354",
                                                                        "action": "start",
                                                                        "tags": "action=\"backup\" plugin=tag(pluginToBackup)"
                                                                    },
                                                                    "order": "1"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            }
                                        ]
                                    }
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": null,
                    "type": "else",
                    "subtype": "action",
                    "options": [],
                    "order": "2",
                    "expressions": [
                        {
                            "type": "element",
                            "subtype": null,
                            "expression": "1181",
                            "options": [],
                            "order": "0",
                            "element": {
                                "name": null,
                                "type": "if",
                                "options": [],
                                "order": "0",
                                "subElements": [
                                    {
                                        "name": null,
                                        "type": "if",
                                        "subtype": "condition",
                                        "options": {
                                            "collapse": "0",
                                            "enable": "1",
                                            "allowRepeatCondition": "0"
                                        },
                                        "order": "0",
                                        "expressions": [
                                            {
                                                "type": "condition",
                                                "subtype": null,
                                                "expression": "strtolower(variable(askActionOnPlugin)) == \"restauration\"",
                                                "options": [],
                                                "order": "0"
                                            }
                                        ]
                                    },
                                    {
                                        "name": null,
                                        "type": "then",
                                        "subtype": "action",
                                        "options": [],
                                        "order": "1",
                                        "expressions": [
                                            {
                                                "type": "element",
                                                "subtype": null,
                                                "expression": "1182",
                                                "options": [],
                                                "order": "0",
                                                "element": {
                                                    "name": null,
                                                    "type": "code",
                                                    "options": [],
                                                    "order": "0",
                                                    "subElements": [
                                                        {
                                                            "name": null,
                                                            "type": "code",
                                                            "subtype": "action",
                                                            "options": {
                                                                "collapse": "0",
                                                                "enable": "1"
                                                            },
                                                            "order": "0",
                                                            "expressions": [
                                                                {
                                                                    "type": "code",
                                                                    "subtype": null,
                                                                    "expression": "$tags = $scenario->getTags();\n\n\/\/ Demande de restauration d'un plugin\n\/\/ Récupération de la liste des plugins sauvegardés\n$dirs = array_values(array_filter(scandir($tags['#backupPath#']), \"pluginsFilter\"));\n$scenario->setLog('Nombre de plugins sauvegardés : ' . sizeof($dirs));\n\n$tags['#savedPluginsList#'] = '';\n$tags['#savedPluginsSize#'] = sizeof($dirs);\nif ($tags['#savedPluginsSize#'] != 0) {\n  $pluginList = array_map('pluginRenderer', $dirs, array_keys($dirs));\n  \/\/ Découpages des plugins par paquets de 10\n  $chunkPluginsList = array_chunk($pluginList, NB_PLUGINS_GROUPED);\n  $scenario->setLog('Nombre de messages : ' . sizeof($chunkPluginsList));\n  \/\/ Envoi de la liste des plugins par paquets\n  array_map('sendMessage', $chunkPluginsList);\n}\n\n$scenario->setTags($tags);",
                                                                    "options": [],
                                                                    "order": "0"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            },
                                            {
                                                "type": "element",
                                                "subtype": null,
                                                "expression": "1183",
                                                "options": [],
                                                "order": "1",
                                                "element": {
                                                    "name": null,
                                                    "type": "if",
                                                    "options": [],
                                                    "order": "0",
                                                    "subElements": [
                                                        {
                                                            "name": null,
                                                            "type": "if",
                                                            "subtype": "condition",
                                                            "options": {
                                                                "collapse": "0",
                                                                "enable": "1",
                                                                "allowRepeatCondition": "0"
                                                            },
                                                            "order": "0",
                                                            "expressions": [
                                                                {
                                                                    "type": "condition",
                                                                    "subtype": null,
                                                                    "expression": "tag(savedPluginsSize) == 0",
                                                                    "options": [],
                                                                    "order": "0"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "name": null,
                                                            "type": "then",
                                                            "subtype": "action",
                                                            "options": [],
                                                            "order": "1",
                                                            "expressions": [
                                                                {
                                                                    "type": "action",
                                                                    "subtype": null,
                                                                    "expression": "#[Notifications][Discord - Infos][Envoi message évolué]#",
                                                                    "options": {
                                                                        "enable": "1",
                                                                        "background": "0",
                                                                        "Titre": "tag(titreRestaurer)",
                                                                        "url": "",
                                                                        "description": "tag(descriptionRestaurationAucunPlugin)",
                                                                        "footer": "tag(scenarioName)",
                                                                        "colors": "#ff0000"
                                                                    },
                                                                    "order": "0"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "name": null,
                                                            "type": "else",
                                                            "subtype": "action",
                                                            "options": [],
                                                            "order": "2",
                                                            "expressions": [
                                                                {
                                                                    "type": "action",
                                                                    "subtype": null,
                                                                    "expression": "ask",
                                                                    "options": {
                                                                        "enable": "1",
                                                                        "background": "0",
                                                                        "question": "tag(askRestaurer)",
                                                                        "answer": "",
                                                                        "variable": "askPluginToRestore",
                                                                        "timeout": "60",
                                                                        "cmd": "#[Notifications][Discord - Infos][Envoi message évolué]#"
                                                                    },
                                                                    "order": "0"
                                                                },
                                                                {
                                                                    "type": "element",
                                                                    "subtype": null,
                                                                    "expression": "1184",
                                                                    "options": [],
                                                                    "order": "1",
                                                                    "element": {
                                                                        "name": null,
                                                                        "type": "if",
                                                                        "options": [],
                                                                        "order": "0",
                                                                        "subElements": [
                                                                            {
                                                                                "name": null,
                                                                                "type": "if",
                                                                                "subtype": "condition",
                                                                                "options": {
                                                                                    "collapse": "0",
                                                                                    "enable": "1",
                                                                                    "allowRepeatCondition": "0"
                                                                                },
                                                                                "order": "0",
                                                                                "expressions": [
                                                                                    {
                                                                                        "type": "condition",
                                                                                        "subtype": null,
                                                                                        "expression": "strtolower(variable(askPluginToRestore)) == \"annuler\"",
                                                                                        "options": [],
                                                                                        "order": "0"
                                                                                    }
                                                                                ]
                                                                            },
                                                                            {
                                                                                "name": null,
                                                                                "type": "then",
                                                                                "subtype": "action",
                                                                                "options": [],
                                                                                "order": "1",
                                                                                "expressions": [
                                                                                    {
                                                                                        "type": "action",
                                                                                        "subtype": null,
                                                                                        "expression": "#[Notifications][Discord - Infos][Envoi message évolué]#",
                                                                                        "options": {
                                                                                            "enable": "1",
                                                                                            "background": "0",
                                                                                            "Titre": "tag(titreRestaurer)",
                                                                                            "url": "",
                                                                                            "description": "tag(descriptionRestaurationAnnulee)",
                                                                                            "footer": "tag(scenarioName)",
                                                                                            "colors": "#ff0000"
                                                                                        },
                                                                                        "order": "0"
                                                                                    }
                                                                                ]
                                                                            },
                                                                            {
                                                                                "name": null,
                                                                                "type": "else",
                                                                                "subtype": "action",
                                                                                "options": [],
                                                                                "order": "2",
                                                                                "expressions": [
                                                                                    {
                                                                                        "type": "element",
                                                                                        "subtype": null,
                                                                                        "expression": "1185",
                                                                                        "options": [],
                                                                                        "order": "0",
                                                                                        "element": {
                                                                                            "name": null,
                                                                                            "type": "code",
                                                                                            "options": [],
                                                                                            "order": "0",
                                                                                            "subElements": [
                                                                                                {
                                                                                                    "name": null,
                                                                                                    "type": "code",
                                                                                                    "subtype": "action",
                                                                                                    "options": {
                                                                                                        "collapse": "0",
                                                                                                        "enable": "1"
                                                                                                    },
                                                                                                    "order": "0",
                                                                                                    "expressions": [
                                                                                                        {
                                                                                                            "type": "code",
                                                                                                            "subtype": null,
                                                                                                            "expression": "$tags = $scenario->getTags();\n\n\/\/ Demande de récupération d'un plugin\n\/\/ Récupération de la liste des plugins sauvegardés\n$scenario->setLog('Récupération de la liste des plugins sauvegardés dans le répertoire ' . $tags['#backupPath']);\n$dirs = array_values(array_filter(scandir($tags['#backupPath#']), \"pluginsFilter\"));\n$pluginId = $scenario->getData(\"askPluginToRestore\");\n$tags['#pluginToRestore#'] = (is_numeric($pluginId) && $pluginId <= sizeof($dirs)) ? $dirs[$pluginId - 1] : \"\";\n\n$scenario->setLog(\"Lancement de la restauration du plugin \" . $tags['#pluginToRestore#']);\n\n$scenario->setTags($tags);",
                                                                                                            "options": [],
                                                                                                            "order": "0"
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    {
                                                                                        "type": "element",
                                                                                        "subtype": null,
                                                                                        "expression": "1186",
                                                                                        "options": [],
                                                                                        "order": "1",
                                                                                        "element": {
                                                                                            "name": null,
                                                                                            "type": "if",
                                                                                            "options": [],
                                                                                            "order": "0",
                                                                                            "subElements": [
                                                                                                {
                                                                                                    "name": null,
                                                                                                    "type": "if",
                                                                                                    "subtype": "condition",
                                                                                                    "options": {
                                                                                                        "collapse": "0",
                                                                                                        "enable": "1",
                                                                                                        "allowRepeatCondition": "0"
                                                                                                    },
                                                                                                    "order": "0",
                                                                                                    "expressions": [
                                                                                                        {
                                                                                                            "type": "condition",
                                                                                                            "subtype": null,
                                                                                                            "expression": "tag(pluginToRestore) == \"\"",
                                                                                                            "options": [],
                                                                                                            "order": "0"
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "name": null,
                                                                                                    "type": "then",
                                                                                                    "subtype": "action",
                                                                                                    "options": [],
                                                                                                    "order": "1",
                                                                                                    "expressions": [
                                                                                                        {
                                                                                                            "type": "action",
                                                                                                            "subtype": null,
                                                                                                            "expression": "#[Notifications][Discord - Infos][Envoi message évolué]#",
                                                                                                            "options": {
                                                                                                                "enable": "1",
                                                                                                                "background": "0",
                                                                                                                "Titre": "tag(titreRestaurer)",
                                                                                                                "url": "",
                                                                                                                "description": "tag(descriptionRestaurationErreur)",
                                                                                                                "footer": "tag(scenarioName)",
                                                                                                                "colors": "#ff0000"
                                                                                                            },
                                                                                                            "order": "0"
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "name": null,
                                                                                                    "type": "else",
                                                                                                    "subtype": "action",
                                                                                                    "options": [],
                                                                                                    "order": "2",
                                                                                                    "expressions": [
                                                                                                        {
                                                                                                            "type": "element",
                                                                                                            "subtype": null,
                                                                                                            "expression": "1228",
                                                                                                            "options": [],
                                                                                                            "order": "0",
                                                                                                            "element": {
                                                                                                                "name": null,
                                                                                                                "type": "comment",
                                                                                                                "options": [],
                                                                                                                "order": "0",
                                                                                                                "subElements": [
                                                                                                                    {
                                                                                                                        "name": null,
                                                                                                                        "type": "comment",
                                                                                                                        "subtype": "comment",
                                                                                                                        "options": {
                                                                                                                            "collapse": "0"
                                                                                                                        },
                                                                                                                        "order": "0",
                                                                                                                        "expressions": [
                                                                                                                            {
                                                                                                                                "type": "comment",
                                                                                                                                "subtype": null,
                                                                                                                                "expression": "- réactiver la commande scénario\n- sélectionner le scénario \"Exécution d actions sur plugins\"",
                                                                                                                                "options": [],
                                                                                                                                "order": "0"
                                                                                                                            }
                                                                                                                        ]
                                                                                                                    }
                                                                                                                ]
                                                                                                            }
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "action",
                                                                                                            "subtype": null,
                                                                                                            "expression": "scenario",
                                                                                                            "options": {
                                                                                                                "enable": "0",
                                                                                                                "background": "0",
                                                                                                                "scenario_id": "354",
                                                                                                                "action": "start",
                                                                                                                "tags": "action=\"restore\" plugin=tag(pluginToRestore)"
                                                                                                            },
                                                                                                            "order": "1"
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    }
                                                                                ]
                                                                            }
                                                                        ]
                                                                    }
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            }
                                        ]
                                    },
                                    {
                                        "name": null,
                                        "type": "else",
                                        "subtype": "action",
                                        "options": [],
                                        "order": "2",
                                        "expressions": [
                                            {
                                                "type": "element",
                                                "subtype": null,
                                                "expression": "1187",
                                                "options": [],
                                                "order": "0",
                                                "element": {
                                                    "name": null,
                                                    "type": "if",
                                                    "options": [],
                                                    "order": "0",
                                                    "subElements": [
                                                        {
                                                            "name": null,
                                                            "type": "if",
                                                            "subtype": "condition",
                                                            "options": {
                                                                "collapse": "0",
                                                                "enable": "1",
                                                                "allowRepeatCondition": "0"
                                                            },
                                                            "order": "0",
                                                            "expressions": [
                                                                {
                                                                    "type": "condition",
                                                                    "subtype": null,
                                                                    "expression": "strtolower(variable(askActionOnPlugin)) == \"mise à jour\"",
                                                                    "options": [],
                                                                    "order": "0"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "name": null,
                                                            "type": "then",
                                                            "subtype": "action",
                                                            "options": [],
                                                            "order": "1",
                                                            "expressions": [
                                                                {
                                                                    "type": "element",
                                                                    "subtype": null,
                                                                    "expression": "1229",
                                                                    "options": [],
                                                                    "order": "0",
                                                                    "element": {
                                                                        "name": null,
                                                                        "type": "comment",
                                                                        "options": [],
                                                                        "order": "0",
                                                                        "subElements": [
                                                                            {
                                                                                "name": null,
                                                                                "type": "comment",
                                                                                "subtype": "comment",
                                                                                "options": {
                                                                                    "collapse": "0"
                                                                                },
                                                                                "order": "0",
                                                                                "expressions": [
                                                                                    {
                                                                                        "type": "comment",
                                                                                        "subtype": null,
                                                                                        "expression": "- réactiver la commande scénario\n- sélectionner le scénario \"update plugins\"",
                                                                                        "options": [],
                                                                                        "order": "0"
                                                                                    }
                                                                                ]
                                                                            }
                                                                        ]
                                                                    }
                                                                },
                                                                {
                                                                    "type": "action",
                                                                    "subtype": null,
                                                                    "expression": "scenario",
                                                                    "options": {
                                                                        "enable": "0",
                                                                        "background": "0",
                                                                        "scenario_id": "355",
                                                                        "action": "start",
                                                                        "tags": ""
                                                                    },
                                                                    "order": "1"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "name": null,
                                                            "type": "else",
                                                            "subtype": "action",
                                                            "options": [],
                                                            "order": "2",
                                                            "expressions": [
                                                                {
                                                                    "type": "element",
                                                                    "subtype": null,
                                                                    "expression": "1188",
                                                                    "options": [],
                                                                    "order": "0",
                                                                    "element": {
                                                                        "name": null,
                                                                        "type": "if",
                                                                        "options": [],
                                                                        "order": "0",
                                                                        "subElements": [
                                                                            {
                                                                                "name": null,
                                                                                "type": "if",
                                                                                "subtype": "condition",
                                                                                "options": {
                                                                                    "collapse": "0",
                                                                                    "enable": "1",
                                                                                    "allowRepeatCondition": "0"
                                                                                },
                                                                                "order": "0",
                                                                                "expressions": [
                                                                                    {
                                                                                        "type": "condition",
                                                                                        "subtype": null,
                                                                                        "expression": "strtolower(variable(askActionOnPlugin)) == \"suppression de sauvegarde\"",
                                                                                        "options": [],
                                                                                        "order": "0"
                                                                                    }
                                                                                ]
                                                                            },
                                                                            {
                                                                                "name": null,
                                                                                "type": "then",
                                                                                "subtype": "action",
                                                                                "options": [],
                                                                                "order": "1",
                                                                                "expressions": [
                                                                                    {
                                                                                        "type": "element",
                                                                                        "subtype": null,
                                                                                        "expression": "1189",
                                                                                        "options": [],
                                                                                        "order": "0",
                                                                                        "element": {
                                                                                            "name": null,
                                                                                            "type": "code",
                                                                                            "options": [],
                                                                                            "order": "0",
                                                                                            "subElements": [
                                                                                                {
                                                                                                    "name": null,
                                                                                                    "type": "code",
                                                                                                    "subtype": "action",
                                                                                                    "options": {
                                                                                                        "collapse": "0",
                                                                                                        "enable": "1"
                                                                                                    },
                                                                                                    "order": "0",
                                                                                                    "expressions": [
                                                                                                        {
                                                                                                            "type": "code",
                                                                                                            "subtype": null,
                                                                                                            "expression": "$tags = $scenario->getTags();\n\n\/\/ Récupération de la liste des plugins sauvegardés\n$scenario->setLog('Récupération de la liste des plugins sauvegardés dans le répertoire ' . $tags['#backupPath']);\n$dirs = array_values(array_filter(scandir($tags['#backupPath#']), \"pluginsFilter\"));\n$scenario->setLog('liste répertoires sauvegardés : ' . $dirs);\n\n$tags['#pluginsToRemoveList#'] = '';\n$tags['#pluginsToRemoveSize#'] = sizeof($dirs);\nif ($tags['#pluginsToRemoveSize#'] != 0) {\n  $pluginList = array_map('pluginRenderer', $dirs, array_keys($dirs));\n  \/\/ Découpages des plugins par paquets de 10\n  $chunkPluginsList = array_chunk($pluginList, NB_PLUGINS_GROUPED);\n  $scenario->setLog('Nombre de messages : ' . sizeof($chunkPluginsList));\n  \/\/ Envoi de la liste des plugins par paquets\n  array_map('sendMessage', $chunkPluginsList);\n}\n\n$scenario->setTags($tags);",
                                                                                                            "options": [],
                                                                                                            "order": "0"
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    {
                                                                                        "type": "element",
                                                                                        "subtype": null,
                                                                                        "expression": "1190",
                                                                                        "options": [],
                                                                                        "order": "1",
                                                                                        "element": {
                                                                                            "name": null,
                                                                                            "type": "if",
                                                                                            "options": [],
                                                                                            "order": "0",
                                                                                            "subElements": [
                                                                                                {
                                                                                                    "name": null,
                                                                                                    "type": "if",
                                                                                                    "subtype": "condition",
                                                                                                    "options": {
                                                                                                        "collapse": "0",
                                                                                                        "enable": "1",
                                                                                                        "allowRepeatCondition": "0"
                                                                                                    },
                                                                                                    "order": "0",
                                                                                                    "expressions": [
                                                                                                        {
                                                                                                            "type": "condition",
                                                                                                            "subtype": null,
                                                                                                            "expression": "tag(pluginsToRemoveSize) == 0",
                                                                                                            "options": [],
                                                                                                            "order": "0"
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "name": null,
                                                                                                    "type": "then",
                                                                                                    "subtype": "action",
                                                                                                    "options": [],
                                                                                                    "order": "1",
                                                                                                    "expressions": [
                                                                                                        {
                                                                                                            "type": "action",
                                                                                                            "subtype": null,
                                                                                                            "expression": "#[Notifications][Discord - Infos][Envoi message évolué]#",
                                                                                                            "options": {
                                                                                                                "enable": "1",
                                                                                                                "background": "0",
                                                                                                                "Titre": "tag(titreSupprimerSauvegarde)",
                                                                                                                "url": "",
                                                                                                                "description": "tag(descriptionSupprimerSauvegardeAucunPlugin)",
                                                                                                                "footer": "tag(scenarioName)",
                                                                                                                "colors": "#ff0000"
                                                                                                            },
                                                                                                            "order": "0"
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "name": null,
                                                                                                    "type": "else",
                                                                                                    "subtype": "action",
                                                                                                    "options": [],
                                                                                                    "order": "2",
                                                                                                    "expressions": [
                                                                                                        {
                                                                                                            "type": "action",
                                                                                                            "subtype": null,
                                                                                                            "expression": "ask",
                                                                                                            "options": {
                                                                                                                "enable": "1",
                                                                                                                "background": "0",
                                                                                                                "question": "tag(askSupprimer)",
                                                                                                                "answer": "",
                                                                                                                "variable": "askPluginToRemove",
                                                                                                                "timeout": "60",
                                                                                                                "cmd": "#[Notifications][Discord - Infos][Envoi message évolué]#"
                                                                                                            },
                                                                                                            "order": "0"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "element",
                                                                                                            "subtype": null,
                                                                                                            "expression": "1202",
                                                                                                            "options": [],
                                                                                                            "order": "1",
                                                                                                            "element": {
                                                                                                                "name": null,
                                                                                                                "type": "if",
                                                                                                                "options": [],
                                                                                                                "order": "0",
                                                                                                                "subElements": [
                                                                                                                    {
                                                                                                                        "name": null,
                                                                                                                        "type": "if",
                                                                                                                        "subtype": "condition",
                                                                                                                        "options": {
                                                                                                                            "collapse": "0",
                                                                                                                            "enable": "1",
                                                                                                                            "allowRepeatCondition": "0"
                                                                                                                        },
                                                                                                                        "order": "0",
                                                                                                                        "expressions": [
                                                                                                                            {
                                                                                                                                "type": "condition",
                                                                                                                                "subtype": null,
                                                                                                                                "expression": "strtolower(variable(askPluginToRemove)) == \"annuler\"",
                                                                                                                                "options": [],
                                                                                                                                "order": "0"
                                                                                                                            }
                                                                                                                        ]
                                                                                                                    },
                                                                                                                    {
                                                                                                                        "name": null,
                                                                                                                        "type": "then",
                                                                                                                        "subtype": "action",
                                                                                                                        "options": [],
                                                                                                                        "order": "1",
                                                                                                                        "expressions": [
                                                                                                                            {
                                                                                                                                "type": "action",
                                                                                                                                "subtype": null,
                                                                                                                                "expression": "#[Notifications][Discord - Infos][Envoi message évolué]#",
                                                                                                                                "options": {
                                                                                                                                    "enable": "1",
                                                                                                                                    "background": "0",
                                                                                                                                    "Titre": "tag(titreSupprimerSauvegarde)",
                                                                                                                                    "url": "",
                                                                                                                                    "description": "tag(descriptionSupprimerSauvegardeAnnulee)",
                                                                                                                                    "footer": "tag(scenarioName)",
                                                                                                                                    "colors": "#ff0000"
                                                                                                                                },
                                                                                                                                "order": "0"
                                                                                                                            }
                                                                                                                        ]
                                                                                                                    },
                                                                                                                    {
                                                                                                                        "name": null,
                                                                                                                        "type": "else",
                                                                                                                        "subtype": "action",
                                                                                                                        "options": [],
                                                                                                                        "order": "2",
                                                                                                                        "expressions": [
                                                                                                                            {
                                                                                                                                "type": "element",
                                                                                                                                "subtype": null,
                                                                                                                                "expression": "1203",
                                                                                                                                "options": [],
                                                                                                                                "order": "0",
                                                                                                                                "element": {
                                                                                                                                    "name": null,
                                                                                                                                    "type": "code",
                                                                                                                                    "options": [],
                                                                                                                                    "order": "0",
                                                                                                                                    "subElements": [
                                                                                                                                        {
                                                                                                                                            "name": null,
                                                                                                                                            "type": "code",
                                                                                                                                            "subtype": "action",
                                                                                                                                            "options": {
                                                                                                                                                "collapse": "0",
                                                                                                                                                "enable": "1"
                                                                                                                                            },
                                                                                                                                            "order": "0",
                                                                                                                                            "expressions": [
                                                                                                                                                {
                                                                                                                                                    "type": "code",
                                                                                                                                                    "subtype": null,
                                                                                                                                                    "expression": "$tags = $scenario->getTags();\n\n\/\/ Demande de suppression d'une sauvegarde de plugin\n\/\/ Récupération de la liste des plugins sauvegardés\n$scenario->setLog('Récupération de la liste des plugins sauvegardés dans le répertoire ' . $tags['#backupPath']);\n$dirs = array_values(array_filter(scandir($tags['#backupPath#']), \"pluginsFilter\"));\n$pluginId = $scenario->getData(\"askPluginToRemove\");\n$tags['#pluginToRemove#'] = (is_numeric($pluginId) && $pluginId <= sizeof($dirs)) ? $dirs[$pluginId - 1] : \"\";\n\n$scenario->setLog(\"Lancement de la suppression de la sauvegarde du plugin \" . $tags['#pluginToRemove#']);\n\n$scenario->setTags($tags);",
                                                                                                                                                    "options": [],
                                                                                                                                                    "order": "0"
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            },
                                                                                                                            {
                                                                                                                                "type": "element",
                                                                                                                                "subtype": null,
                                                                                                                                "expression": "1192",
                                                                                                                                "options": [],
                                                                                                                                "order": "1",
                                                                                                                                "element": {
                                                                                                                                    "name": null,
                                                                                                                                    "type": "if",
                                                                                                                                    "options": [],
                                                                                                                                    "order": "0",
                                                                                                                                    "subElements": [
                                                                                                                                        {
                                                                                                                                            "name": null,
                                                                                                                                            "type": "if",
                                                                                                                                            "subtype": "condition",
                                                                                                                                            "options": {
                                                                                                                                                "collapse": "0",
                                                                                                                                                "enable": "1",
                                                                                                                                                "allowRepeatCondition": "0"
                                                                                                                                            },
                                                                                                                                            "order": "0",
                                                                                                                                            "expressions": [
                                                                                                                                                {
                                                                                                                                                    "type": "condition",
                                                                                                                                                    "subtype": null,
                                                                                                                                                    "expression": "tag(pluginToRemove) == \"\"",
                                                                                                                                                    "options": [],
                                                                                                                                                    "order": "0"
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "name": null,
                                                                                                                                            "type": "then",
                                                                                                                                            "subtype": "action",
                                                                                                                                            "options": [],
                                                                                                                                            "order": "1",
                                                                                                                                            "expressions": [
                                                                                                                                                {
                                                                                                                                                    "type": "action",
                                                                                                                                                    "subtype": null,
                                                                                                                                                    "expression": "#[Notifications][Discord - Infos][Envoi message évolué]#",
                                                                                                                                                    "options": {
                                                                                                                                                        "enable": "1",
                                                                                                                                                        "background": "0",
                                                                                                                                                        "Titre": "tag(titreSupprimerSauvegarde)",
                                                                                                                                                        "url": "",
                                                                                                                                                        "description": "tag(descriptionSupprimerSauvegardeErreur)",
                                                                                                                                                        "footer": "tag(scenarioName)",
                                                                                                                                                        "colors": "#ff0000"
                                                                                                                                                    },
                                                                                                                                                    "order": "0"
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "name": null,
                                                                                                                                            "type": "else",
                                                                                                                                            "subtype": "action",
                                                                                                                                            "options": [],
                                                                                                                                            "order": "2",
                                                                                                                                            "expressions": [
                                                                                                                                                {
                                                                                                                                                    "type": "element",
                                                                                                                                                    "subtype": null,
                                                                                                                                                    "expression": "1226",
                                                                                                                                                    "options": [],
                                                                                                                                                    "order": "0",
                                                                                                                                                    "element": {
                                                                                                                                                        "name": null,
                                                                                                                                                        "type": "comment",
                                                                                                                                                        "options": [],
                                                                                                                                                        "order": "0",
                                                                                                                                                        "subElements": [
                                                                                                                                                            {
                                                                                                                                                                "name": null,
                                                                                                                                                                "type": "comment",
                                                                                                                                                                "subtype": "comment",
                                                                                                                                                                "options": {
                                                                                                                                                                    "collapse": "0"
                                                                                                                                                                },
                                                                                                                                                                "order": "0",
                                                                                                                                                                "expressions": [
                                                                                                                                                                    {
                                                                                                                                                                        "type": "comment",
                                                                                                                                                                        "subtype": null,
                                                                                                                                                                        "expression": "- réactiver la commande scénario\n- sélectionner le scénario \"Exécution d actions sur plugins\"",
                                                                                                                                                                        "options": [],
                                                                                                                                                                        "order": "0"
                                                                                                                                                                    }
                                                                                                                                                                ]
                                                                                                                                                            }
                                                                                                                                                        ]
                                                                                                                                                    }
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "action",
                                                                                                                                                    "subtype": null,
                                                                                                                                                    "expression": "scenario",
                                                                                                                                                    "options": {
                                                                                                                                                        "enable": "0",
                                                                                                                                                        "background": "0",
                                                                                                                                                        "scenario_id": "354",
                                                                                                                                                        "action": "start",
                                                                                                                                                        "tags": "action=\"remove\" plugin=tag(pluginToRemove)"
                                                                                                                                                    },
                                                                                                                                                    "order": "1"
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            }
                                                                                                                        ]
                                                                                                                    }
                                                                                                                ]
                                                                                                            }
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    }
                                                                                ]
                                                                            },
                                                                            {
                                                                                "name": null,
                                                                                "type": "else",
                                                                                "subtype": "action",
                                                                                "options": [],
                                                                                "order": "2",
                                                                                "expressions": [
                                                                                    {
                                                                                        "type": "element",
                                                                                        "subtype": null,
                                                                                        "expression": "1193",
                                                                                        "options": [],
                                                                                        "order": "0",
                                                                                        "element": {
                                                                                            "name": null,
                                                                                            "type": "if",
                                                                                            "options": [],
                                                                                            "order": "0",
                                                                                            "subElements": [
                                                                                                {
                                                                                                    "name": null,
                                                                                                    "type": "if",
                                                                                                    "subtype": "condition",
                                                                                                    "options": {
                                                                                                        "collapse": "0",
                                                                                                        "enable": "1",
                                                                                                        "allowRepeatCondition": "0"
                                                                                                    },
                                                                                                    "order": "0",
                                                                                                    "expressions": [
                                                                                                        {
                                                                                                            "type": "condition",
                                                                                                            "subtype": null,
                                                                                                            "expression": "strtolower(variable(askActionOnPlugin)) == \"annuler\"",
                                                                                                            "options": [],
                                                                                                            "order": "0"
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "name": null,
                                                                                                    "type": "then",
                                                                                                    "subtype": "action",
                                                                                                    "options": [],
                                                                                                    "order": "1",
                                                                                                    "expressions": [
                                                                                                        {
                                                                                                            "type": "action",
                                                                                                            "subtype": null,
                                                                                                            "expression": "#[Notifications][Discord - Infos][Envoi message évolué]#",
                                                                                                            "options": {
                                                                                                                "enable": "1",
                                                                                                                "background": "0",
                                                                                                                "Titre": "tag(titreAnnulerActions)",
                                                                                                                "url": "",
                                                                                                                "description": "tag(descriptionAnnulerActions)",
                                                                                                                "footer": "tag(scenarioName)",
                                                                                                                "colors": "#ff0000"
                                                                                                            },
                                                                                                            "order": "0"
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "name": null,
                                                                                                    "type": "else",
                                                                                                    "subtype": "action",
                                                                                                    "options": [],
                                                                                                    "order": "2",
                                                                                                    "expressions": [
                                                                                                        {
                                                                                                            "type": "action",
                                                                                                            "subtype": null,
                                                                                                            "expression": "#[Notifications][Discord - Infos][Envoi message évolué]#",
                                                                                                            "options": {
                                                                                                                "enable": "1",
                                                                                                                "background": "0",
                                                                                                                "Titre": "tag(titreActionInconnue)",
                                                                                                                "url": "",
                                                                                                                "description": "tag(descriptionActionInconnue)",
                                                                                                                "footer": "tag(scenarioName)",
                                                                                                                "colors": "#ff0000"
                                                                                                            },
                                                                                                            "order": "0"
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    }
                                                                                ]
                                                                            }
                                                                        ]
                                                                    }
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            }
                                        ]
                                    }
                                ]
                            }
                        }
                    ]
                }
            ]
        }
    ]
}